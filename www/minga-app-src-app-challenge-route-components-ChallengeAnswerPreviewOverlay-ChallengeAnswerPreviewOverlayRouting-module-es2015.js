(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{G1e9:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("mrSG"),a=n("8Y7J"),r=n("WH00");let o=(()=>{class t{constructor(t){this.contentEvents=t}trigger(t,e,n){return Object(i.a)(this,void 0,void 0,(function*(){n.allPassed?yield this._moderationSuccessDialog(t,e,n):yield this._moderationFailDialog(t,e,n)}))}_moderationSuccessDialog(t,e,n){return Object(i.a)(this,void 0,void 0,(function*(){this.contentEvents.emitSuccessModeration({})}))}_moderationFailDialog(t,e,n){return Object(i.a)(this,void 0,void 0,(function*(){this.contentEvents.emitFailedModeration({contentHash:t,contextHash:e,textFailed:!n.allTextContentPassed,imageFailed:!n.allImageContentPassed,imageTextFailed:!n.allImageTextContentPassed&&n.allImageContentPassed,imageAndTextFailed:!n.allImageTextContentPassed&&!n.allImageContentPassed,tags:n.tags,imageTags:n.imageTags,emailContentSend:null}),yield new Promise(t=>setTimeout(t,300))}))}}return t.\u0275fac=function(e){return new(e||t)(a["\u0275\u0275inject"](r.a))},t.\u0275prov=a["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},uDiC:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n("mrSG"),a=n("8Y7J"),r=n("LvDl"),o=n("5km/"),s=n("6GgV"),d=n("orC8"),c=n("iELJ");function l(t,...e){return r.merge(t,...e)}let u=(()=>{class t{constructor(t,e){this.userStorage=t,this.matDialog=e,this._pendingDraft={}}cancelDraft(){return Object(i.a)(this,void 0,void 0,(function*(){let t=this.matDialog.open(o.g);const e=yield t.beforeClosed().toPromise();if("keep"===e)return"";if("discard"===e)return yield this.clearDraft(),"";throw new Error("User abort")}))}getDraftType(t){return Object(i.a)(this,void 0,void 0,(function*(){if(!t){const e=yield this.getDraft();if(!e)throw new Error("No Challenge Response Draft found for draft type!");t=e}return t.type}))}clearDraft(){return Object(i.a)(this,void 0,void 0,(function*(){yield this.userStorage.setItem("MingaChallengeResponseDraft",null)}))}getDraft(){return Object(i.a)(this,void 0,void 0,(function*(){return(yield this.userStorage.getItem("MingaChallengeResponseDraft"))||null}))}getDraftDefaulted(t,e){return Object(i.a)(this,void 0,void 0,(function*(){let n=yield this.getDraft();return(!n||t&&n.ownerContextHash!=t)&&(n=yield e(),yield this.storeDraft(n)),n}))}getDefaultResponse(){return{body:"",privacy:s.ChallengePrivacy.PUBLIC,type:s.ChallengeType.TEXT}}getDraftAssert(){return Object(i.a)(this,void 0,void 0,(function*(){return(yield this.getDraft())||{}}))}saveDraft(t){return Object(i.a)(this,void 0,void 0,(function*(){const e=Object.assign({},this._pendingDraft);this._pendingDraft=l(e,t),yield this.savePendingDraft()}))}saveDraftDelayed(t,e=1e3){const n=Object.assign({},this._pendingDraft);this._pendingDraft=l(n,t),clearTimeout(this.draftSaveTimeout),this.draftSaveTimeout=setTimeout(()=>this.savePendingDraft(),e)}savePendingDraft(){return Object(i.a)(this,void 0,void 0,(function*(){clearTimeout(this.draftSaveTimeout);const t=Object.assign({},this._pendingDraft);this._pendingDraft={};const e=l(yield this.getDraftAssert(),t);!t.banner&&t.backgroundColor?e.banner=void 0:t.banner&&!t.backgroundColor&&(e.backgroundColor=void 0),yield this.storeDraft(e)}))}storeDraft(t){return Object(i.a)(this,void 0,void 0,(function*(){yield this.userStorage.setItem("MingaChallengeResponseDraft",t)}))}}return t.\u0275fac=function(e){return new(e||t)(a["\u0275\u0275inject"](d.a),a["\u0275\u0275inject"](c.b))},t.\u0275prov=a["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);
//# sourceMappingURL=minga-app-src-app-challenge-route-components-ChallengeAnswerPreviewOverlay-ChallengeAnswerPreviewOverlayRouting-module-es2015.js.map