!function(){function e(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function t(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t=function(){return e};var e={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(S){l=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var r=t&&t.prototype instanceof p?t:p,a=Object.create(r.prototype),s=new M(i||[]);return o(a,"_invoke",{value:x(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(S){return{type:"throw",arg:S}}}e.wrap=u;var d={};function p(){}function f(){}function g(){}var m={};l(m,a,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(E([])));y&&y!==n&&i.call(y,a)&&(m=y);var b=g.prototype=p.prototype=Object.create(m);function C(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){var n;o(this,"_invoke",{value:function(o,r){function a(){return new t((function(n,a){!function n(o,r,a,s){var c=h(e[o],e,r);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}(o,r,n,a)}))}return n=n?n.then(a,a):a()}})}function x(e,t,n){var i="suspendedStart";return function(o,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw r;return P()}for(n.method=o,n.arg=r;;){var a=n.delegate;if(a){var s=O(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var c=h(e,t,n);if("normal"===c.type){if(i=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i="completed",n.method="throw",n.arg=c.arg)}}}function O(e,t){var n=t.method,i=e.iterator[n];if(void 0===i)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=h(i,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var r=o.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function E(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return f.prototype=g,o(b,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=l(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},C(_.prototype),l(_.prototype,s,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,i,o,r){void 0===r&&(r=Promise);var a=new _(u(t,n,i,o),r);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(b),l(b,c,"Generator"),l(b,a,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=E,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],a=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var s=i.call(r,"catchLoc"),c=i.call(r,"finallyLoc");if(s&&c){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function n(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r,a,s=[],c=!0,l=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=r.call(n)).done)&&(s.push(i.value),s.length!==t);c=!0);}catch(u){l=!0,o=u}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,r=void 0,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"))?r:String(r)),i)}var o,r}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{"2UAs":function(o,r,s){"use strict";s.r(r),s.d(r,"AddGalleryPhotoRouteModule",(function(){return Ze}));var l,u,h=s("SVse"),d=s("8Y7J"),p=s("u9T3"),f=s("iInd"),g=s("CO6v"),m=s("CL15"),v=s("Vwx4"),y=s("s7LF"),b=s("Q2Ze"),C=s("f44v"),_=s("Tj54"),x=s("1z/I"),O=s("HBJn"),w=((u=function(){function e(t,n,i,o){a(this,e),this._service=t,this._templateRef=n,this._viewContainerRef=i,this._cdr=o,this._subscription=null,this._templatePortal=new x.g(this._templateRef,this._viewContainerRef)}return c(e,[{key:"ngOnInit",value:function(){var e=this;this._subscription=this._service.push(this._templatePortal).subscribe((function(){return e._cdr.detectChanges()}))}},{key:"ngOnDestroy",value:function(){this._service.remove(this._templatePortal),this._subscription&&(this._subscription.unsubscribe(),this._subscription=null)}}]),e}()).\u0275fac=function(e){return new(e||u)(d["\u0275\u0275directiveInject"](O.a),d["\u0275\u0275directiveInject"](d.TemplateRef),d["\u0275\u0275directiveInject"](d.ViewContainerRef),d["\u0275\u0275directiveInject"](d.ChangeDetectorRef))},u.\u0275dir=d["\u0275\u0275defineDirective"]({type:u,selectors:[["","globalFloatingPortal",""]]}),u),k=((l=c((function e(){a(this,e)}))).\u0275fac=function(e){return new(e||l)},l.\u0275mod=d["\u0275\u0275defineNgModule"]({type:l}),l.\u0275inj=d["\u0275\u0275defineInjector"]({imports:[[]]}),l),M=s("7Tcv"),E=s("mrSG"),P=s("XNiG"),S=s("LvDl"),j=s("LfDn"),F=s("itXk"),I=s("lJxs"),H=s("pLZG"),T=s("IzEk"),A=s("vkgz"),L=s("oW4M"),G=s("TxG7");function D(e){return e.shortCard?{contentHash:e.shortCard.contentHash,previewTitle:e.shortCard.title||e.shortCard.body}:e.shortEventCard?{contentHash:e.shortEventCard.contentHash,previewTitle:e.shortEventCard.title||e.shortEventCard.body}:null}function z(e){return D(e.item)}function q(e){return t=e.item,(n=t.feedItem)?D(n):null;var t,n}var R,N=((R=function(){function e(t,n){a(this,e),this.searchManagerProto=t,this.contentFeed=n}return c(e,[{key:"findContent",value:function(e){var t={};e.contentType&&(t.contentType=Array.isArray(e.contentType)?e.contentType.join(","):e.contentType,t.contentType||delete t.contentType),e.group&&(t.groupHashes=Array.isArray(e.group)?e.group.join(","):e.group);var o=Object(j.a)(this.searchManagerProto,"searchControl","search",Object.assign(Object.assign({},t),{query:e.query}));o.seekFront();var r=Object(j.a)(this.contentFeed,"streamContentFeedControl","streamContentFeed",Object.assign({},t));r.seekFront();var a=Object(F.b)(o.loading$,o.asObservable()).pipe(Object(I.a)((function(e){var t=i(e,2);return t[0],t[1]})),Object(H.a)((function(e){return e.length>0||o.isDone})),Object(T.a)(1),Object(I.a)((function(e){return e.map(q).filter((function(e){return!!e}))})),Object(I.a)((function(e){return e})),Object(A.a)((function(){return o.close()}))),s=Object(F.b)(r.loading$,r.asObservable()).pipe(Object(I.a)((function(e){var t=i(e,2);return t[0],t[1]})),Object(H.a)((function(e){return e.length>0||r.isDone})),Object(T.a)(1),Object(I.a)((function(e){return e.map(z).filter((function(e){return!!e}))})),Object(I.a)((function(e){return e})),Object(A.a)((function(){return r.close()})));return Object(F.b)(a,s).pipe(Object(I.a)((function(e){var t=i(e,2),o=t[0],r=t[1];return[].concat(n(o),n(r))})),Object(I.a)((function(e){return S.uniqWith(e,(function(e,t){return e.contentHash==t.contentHash}))})))}}]),e}()).\u0275fac=function(e){return new(e||R)(d["\u0275\u0275inject"](L.SearchManager),d["\u0275\u0275inject"](G.ContentFeed))},R.\u0275prov=d["\u0275\u0275defineInjectable"]({token:R,factory:R.\u0275fac,providedIn:"root"}),R),U=s("YEUz"),V=s("VDRc"),Q=["contentOptionsContainer"],$=["inputElement"],B=["inputMeasurePlaceholder"];function W(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div",10),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=t.$implicit,i=d["\u0275\u0275nextContext"](2);return i._selectOption(e),i.focusInput()}))("mousedown",(function(){d["\u0275\u0275restoreView"](n);var e=t.$implicit,i=d["\u0275\u0275nextContext"](2);return i._selectOption(e),i.focusInput()})),d["\u0275\u0275element"](1,"div",11),d["\u0275\u0275elementStart"](2,"div",12),d["\u0275\u0275text"](3),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,o=t.index,r=d["\u0275\u0275nextContext"](2);d["\u0275\u0275classProp"]("highlighted",r._highlightedOption==o),d["\u0275\u0275advance"](1),d["\u0275\u0275styleProp"]("background-image","url("+i.imageUrl+")"),d["\u0275\u0275advance"](2),d["\u0275\u0275textInterpolate"](i.previewTitle)}}function J(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",7,8),d["\u0275\u0275template"](2,W,4,5,"div",9),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]();d["\u0275\u0275styleProp"]("display",n.focused&&n._options.length>0?"":"none"),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngForOf",n._options)}}function K(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"mat-chip",13),d["\u0275\u0275listener"]("removed",(function(){d["\u0275\u0275restoreView"](n);var e=t.index;return d["\u0275\u0275nextContext"]()._removeSelected(e)})),d["\u0275\u0275text"](1),d["\u0275\u0275elementStart"](2,"mat-icon",14),d["\u0275\u0275text"](3,"cancel"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit;d["\u0275\u0275property"]("removable",!0)("selectable",!0),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"](" ",i.previewTitle," ")}}var X,Y,Z={provide:b.e,useExisting:Object(d.forwardRef)((function(){return ee}))},ee=((Y=function(){function e(t,n,i,o,r){a(this,e),this.contentFinder=t,this.cdr=n,this.fm=i,this._injector=o,this._matFormField=r,this._focused=!1,this._ngControl=null,this._options=[],this._highlightedOption=-1,this._searchText="",this.contentType=[],this.group="",this.selectedContent=[],this.allowDuplicates=!1,this.required=!1,this.placeholder="",this.disabled=!1,this.controlType="mg-content-select",this._stateChanges=new P.a,this.stateChanges=this._stateChanges.asObservable(),this.selectedContentChange=new d.EventEmitter}return c(e,[{key:"id",get:function(){return""}},{key:"focused",get:function(){return this._focused}},{key:"empty",get:function(){return 0===this.selectedContent.length}},{key:"shouldLabelFloat",get:function(){return this.focused||!this.empty||this._searchText.length>0}},{key:"ngControl",get:function(){return this._ngControl}},{key:"errorState",get:function(){return!!(this.ngControl&&this.ngControl.touched&&(this.ngControl.invalid||this.required&&this.empty))}},{key:"value",get:function(){return this.selectedContent.map((function(e){return e.contentHash}))}},{key:"setDescribedByIds",value:function(e){}},{key:"onContainerClick",value:function(e){}},{key:"ngOnInit",value:function(){var e,t=this;this._ngControl=this._injector.get(y.s),null!=this._ngControl&&(this._ngControl.valueAccessor=this),this.fm.monitor(null===(e=this.inputElement)||void 0===e?void 0:e.nativeElement).subscribe((function(e){return requestAnimationFrame((function(){t._focused=null!==e,t.cdr.markForCheck()}))}))}},{key:"ngOnDestroy",value:function(){this._optionsSub&&(this._optionsSub.unsubscribe(),delete this._optionsSub)}},{key:"focusInput",value:function(){var e;(null===(e=this.inputElement)||void 0===e?void 0:e.nativeElement)&&this.fm.focusVia(this.inputElement.nativeElement,"program")}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.selectedContent=[],e&&this.selectedContentChange.emit(this.selectedContent)}},{key:"setFromStringArray",value:function(e){return Object(E.a)(this,void 0,void 0,t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"_onSearchTextChange",value:function(e){var t=this;this._optionsSub&&(this._optionsSub.unsubscribe(),delete this._optionsSub),e&&(this._optionsSub=this.contentFinder.findContent({query:e,contentType:this.contentType,group:this.group}).subscribe((function(e){t.allowDuplicates||(e=e.filter((function(e){return-1===t.selectedContent.findIndex((function(t){return t.contentHash===e.contentHash}))}))),t._options=e.slice(0,5),t.cdr.markForCheck(),t._repositionOptionsContainer()}))),requestAnimationFrame((function(){return t._resizeInputElement()}))}},{key:"_onSearchKeypress",value:function(e){if(this._searchText)switch(e.key){case"Tab":case"Enter":e.preventDefault(),e.stopPropagation(),this._selectHighlightedOption();break;case"ArrowUp":e.preventDefault(),e.stopPropagation(),this._highlightOptionUp();break;case"ArrowDown":this._highlightOptionDown(),e.preventDefault(),e.stopPropagation()}}},{key:"_highlightOptionUp",value:function(){this._highlightedOption=Math.max(0,this._highlightedOption-1),this.cdr.markForCheck()}},{key:"_highlightOptionDown",value:function(){this._highlightedOption=Math.min(this._options.length-1,this._highlightedOption+1),this.cdr.markForCheck()}},{key:"_selectHighlightedOption",value:function(){var e=Math.max(0,this._highlightedOption);this._options[e]&&this._selectOption(this._options[e])}},{key:"_selectOption",value:function(e){this.selectedContent.push(e),this._options=[],this._highlightedOption=-1,this._searchText="",this.cdr.markForCheck(),this.selectedContentChange.emit(this.selectedContent),this._onChange&&this._onChange(this.selectedContent)}},{key:"_removeSelected",value:function(e){this.selectedContent.splice(e,1),this.selectedContentChange.emit(this.selectedContent),this._onChange&&this._onChange(this.selectedContent),this.cdr.markForCheck()}},{key:"registerOnChange",value:function(e){this._onChange=e}},{key:"registerOnTouched",value:function(e){this._onTouched=e}},{key:"writeValue",value:function(e){null===e?this.clear():Array.isArray(e)?this.setFromStringArray(e):(console.warn("Invalid write value to mg-mentionable-select:",e),this.clear())}},{key:"_onFocus",value:function(){this.focusInput()}},{key:"_onClick",value:function(){this.focusInput()}},{key:"_onResize",value:function(){var e=this;requestAnimationFrame((function(){return e._repositionOptionsContainer()}))}},{key:"_onScroll",value:function(){var e=this;this.focused&&requestAnimationFrame((function(){return e._repositionOptionsContainer()}))}},{key:"_resizeInputElement",value:function(){var e,t,n=this,i=null===(e=this.inputElement)||void 0===e?void 0:e.nativeElement,o=null===(t=this.inputMeasurePlaceholder)||void 0===t?void 0:t.nativeElement;if(i&&o){var r=getComputedStyle(o);i.style.width=parseInt(r.width)+10+"px",requestAnimationFrame((function(){return n._repositionOptionsContainer()}))}}},{key:"_repositionOptionsContainer",value:function(){var e,t,n=null===(e=this.contentOptionsContainer)||void 0===e?void 0:e.nativeElement;if(n){var i=null===(t=this.inputElement)||void 0===t?void 0:t.nativeElement;if(i){var o=document.body.getBoundingClientRect(),r=i.getBoundingClientRect();n.style.transform="",n.style.left="".concat(r.right,"px"),n.style.top=r.top-o.top+"px",n.getBoundingClientRect().right>innerWidth&&(n.style.left="100vw",n.style.transform="translateX(-100%)",n.style.top=r.bottom-o.top+"px")}}}}]),e}()).\u0275fac=function(e){return new(e||Y)(d["\u0275\u0275directiveInject"](N),d["\u0275\u0275directiveInject"](d.ChangeDetectorRef),d["\u0275\u0275directiveInject"](U.h),d["\u0275\u0275directiveInject"](d.Injector),d["\u0275\u0275directiveInject"](b.d,8))},Y.\u0275cmp=d["\u0275\u0275defineComponent"]({type:Y,selectors:[["mg-content-select"]],viewQuery:function(e,t){var n;1&e&&(d["\u0275\u0275viewQuery"](Q,1),d["\u0275\u0275viewQuery"]($,3),d["\u0275\u0275viewQuery"](B,3)),2&e&&(d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.contentOptionsContainer=n.first),d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.inputElement=n.first),d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.inputMeasurePlaceholder=n.first))},hostBindings:function(e,t){1&e&&d["\u0275\u0275listener"]("focus",(function(){return t._onFocus()}))("click",(function(){return t._onClick()}))("resize",(function(){return t._onResize()}),!1,d["\u0275\u0275resolveWindow"])("scroll",(function(){return t._onScroll()}),!1,d["\u0275\u0275resolveWindow"])},inputs:{contentType:"contentType",group:"group",selectedContent:"selectedContent",allowDuplicates:"allowDuplicates",required:"required",placeholder:"placeholder",disabled:"disabled"},outputs:{selectedContentChange:"selectedContentChange"},features:[d["\u0275\u0275ProvidersFeature"]([Z])],decls:9,vars:3,consts:[[1,"mg-content-select-inner"],["class","content-options-container",3,"display",4,"globalFloatingPortal"],["class","mg-content-select-mat-chip",3,"removable","selectable","removed",4,"ngFor","ngForOf"],[1,"search-input","measure-placeholder"],["inputMeasurePlaceholder",""],["type","text","maxlength","32",1,"search-input",3,"ngModel","keydown","ngModelChange"],["inputElement",""],[1,"content-options-container"],["contentOptionsContainer",""],["class","content-option","fxLayout","row","fxLayoutAlign","start center",3,"highlighted","click","mousedown",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center",1,"content-option",3,"click","mousedown"],[1,"content-option-icon"],["fxFlex","auto"],[1,"mg-content-select-mat-chip",3,"removable","selectable","removed"],["matChipRemove",""]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"label",0),d["\u0275\u0275template"](1,J,3,3,"div",1),d["\u0275\u0275elementStart"](2,"mat-chip-list"),d["\u0275\u0275template"](3,K,4,3,"mat-chip",2),d["\u0275\u0275elementStart"](4,"span",3,4),d["\u0275\u0275text"](6),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](7,"input",5,6),d["\u0275\u0275listener"]("keydown",(function(e){return t._onSearchKeypress(e)}))("ngModelChange",(function(e){return t._searchText=e}))("ngModelChange",(function(e){return t._onSearchTextChange(e)})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngForOf",t.selectedContent),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate"](t._searchText),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngModel",t._searchText))},directives:[w,C.c,h.n,y.d,y.n,y.t,y.w,V.e,V.d,V.b,C.a,_.a,C.d],styles:['@import url("https://fonts.googleapis.com/css?family=Muli:400,700,900");.mg-content-select-inner[_ngcontent-%COMP%]{margin:8px 0}mat-chip.mg-content-select-mat-chip[_ngcontent-%COMP%]{min-height:25px;margin-right:4px;font-family:Muli,sans-serif;line-height:1.35}@media (orientation:landscape){mat-chip.mg-content-select-mat-chip[_ngcontent-%COMP%]{font-size:2.8985507246vh}}@media (orientation:portrait){mat-chip.mg-content-select-mat-chip[_ngcontent-%COMP%]{font-size:2.8985507246vw}}@media (orientation:landscape) and (max-height:414px){mat-chip.mg-content-select-mat-chip[_ngcontent-%COMP%]{font-size:12px}}@media (orientation:portrait) and (max-width:414px){mat-chip.mg-content-select-mat-chip[_ngcontent-%COMP%]{font-size:12px}}@media (min-width:448.5px){mat-chip.mg-content-select-mat-chip[_ngcontent-%COMP%]{font-size:13px}}.content-options-container[_ngcontent-%COMP%]{position:absolute;background:#fff 0 0 no-repeat padding-box;box-shadow:0 0 6px rgba(0,0,0,.1607843137254902);border:1px solid #ccc;border-radius:4px;padding:4px 0}.content-options-container[_ngcontent-%COMP%]   .content-option[_ngcontent-%COMP%]{white-space:nowrap;padding:4px 16px;cursor:pointer;font-family:Muli,sans-serif;line-height:1.35}@media (orientation:landscape){.content-options-container[_ngcontent-%COMP%]   .content-option[_ngcontent-%COMP%]{font-size:2.8985507246vh}}@media (orientation:portrait){.content-options-container[_ngcontent-%COMP%]   .content-option[_ngcontent-%COMP%]{font-size:2.8985507246vw}}@media (orientation:landscape) and (max-height:414px){.content-options-container[_ngcontent-%COMP%]   .content-option[_ngcontent-%COMP%]{font-size:12px}}@media (orientation:portrait) and (max-width:414px){.content-options-container[_ngcontent-%COMP%]   .content-option[_ngcontent-%COMP%]{font-size:12px}}@media (min-width:448.5px){.content-options-container[_ngcontent-%COMP%]   .content-option[_ngcontent-%COMP%]{font-size:13px}}.content-options-container[_ngcontent-%COMP%]   .content-option[_ngcontent-%COMP%]   .content-img[_ngcontent-%COMP%]{min-width:16px;max-width:16px;height:16px;border-radius:50%;margin-right:6px;background-color:#fff;background-position:50%;background-size:cover;border:1px solid #ccc;box-sizing:border-box}.content-options-container[_ngcontent-%COMP%]   .content-option.highlighted[_ngcontent-%COMP%], .content-options-container[_ngcontent-%COMP%]   .content-option[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.content-options-container[_ngcontent-%COMP%]:hover.highlighted{background-color:unset}.search-input[_ngcontent-%COMP%]{background-color:initial;display:inline-block;border:0;padding:0;margin:0;min-width:1em;min-width:1ch;outline:none}.search-input.measure-placeholder[_ngcontent-%COMP%]{position:absolute;opacity:0;-webkit-user-select:none;user-select:none;pointer-events:none}'],changeDetection:0}),Y),te=((X=c((function e(){a(this,e)}))).\u0275fac=function(e){return new(e||X)},X.\u0275mod=d["\u0275\u0275defineNgModule"]({type:X}),X.\u0275inj=d["\u0275\u0275defineInjector"]({imports:[[k,M.a,h.c,y.m,p.a,C.e,_.b]]}),X),ne=s("yUAh"),ie=s("+/Hu"),oe=s("2Vo4"),re=s("Kj3r"),ae=s("UXun"),se=s("/uUt"),ce=s("SxV6"),le=s("eIep"),ue=["mentionableOptionsContainer"],he=["inputElement"],de=["inputMeasurePlaceholder"];function pe(e,t){if(1&e&&d["\u0275\u0275element"](0,"div",13),2&e){var n=d["\u0275\u0275nextContext"]().$implicit;d["\u0275\u0275styleProp"]("background-image","url("+n.imageUrl+")")}}function fe(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div",10),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=t.$implicit,i=d["\u0275\u0275nextContext"](2);return i._selectOption(e),i.focusInput()}))("mousedown",(function(){d["\u0275\u0275restoreView"](n);var e=t.$implicit,i=d["\u0275\u0275nextContext"](2);return i._selectOption(e),i.focusInput()})),d["\u0275\u0275template"](1,pe,1,2,"div",11),d["\u0275\u0275elementStart"](2,"div",12),d["\u0275\u0275text"](3),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,o=t.index,r=d["\u0275\u0275nextContext"](2);d["\u0275\u0275classProp"]("highlighted",r._highlightedOption==o),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngIf",i.imageUrl),d["\u0275\u0275advance"](2),d["\u0275\u0275textInterpolate"](i.displayName)}}function ge(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",7,8),d["\u0275\u0275template"](2,fe,4,4,"div",9),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]();d["\u0275\u0275styleProp"]("display",n.focused&&n._options.length>0?"":"none"),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngForOf",n._options)}}function me(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"mat-icon",16),d["\u0275\u0275text"](1,"cancel"),d["\u0275\u0275elementEnd"]())}function ve(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"mat-chip",14),d["\u0275\u0275listener"]("removed",(function(){d["\u0275\u0275restoreView"](n);var e=t.index;return d["\u0275\u0275nextContext"]()._removeSelected(e)})),d["\u0275\u0275text"](1),d["\u0275\u0275template"](2,me,2,0,"mat-icon",15),d["\u0275\u0275elementEnd"]()}if(2&e){var i=t.$implicit,o=d["\u0275\u0275nextContext"]();d["\u0275\u0275property"]("removable",!o.uneditableMentions.includes(i.hash))("selectable",!o.uneditableMentions.includes(i.hash)),d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"](" ",i.displayName," "),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngIf",!o.uneditableMentions.includes(i.hash))}}var ye,be,Ce,_e,xe,Oe,we={provide:b.e,useExisting:Object(d.forwardRef)((function(){return ke}))},ke=((be=function(){function n(e,t,i,o,r){a(this,n),this.mentionsService=e,this.cdr=t,this.fm=i,this._injector=o,this._matFormField=r,this._focused=!1,this._options=[],this._highlightedOption=-1,this._searchText="",this._searchText$=new oe.a(""),this.selectedMentionables=[],this.allowDuplicates=!1,this.options={searchGroups:!0,searchPeople:!0},this._ngControl=null,this.required=!1,this.placeholder="",this.disabled=!1,this.uneditableMentions=[],this.controlType="mg-mentionable-select",this._stateChanges=new P.a,this.stateChanges=this._stateChanges.asObservable(),this.selectedMentionablesChange=new d.EventEmitter,this.searchText$=this._searchText$.asObservable(),this.searchTextDebounced$=this.searchText$.pipe(Object(re.a)(300),Object(ae.a)(1),Object(se.a)())}return c(n,[{key:"id",get:function(){return""}},{key:"focused",get:function(){return this._focused}},{key:"empty",get:function(){return 0===this.selectedMentionables.length}},{key:"shouldLabelFloat",get:function(){return this.focused||!this.empty||this._searchText.length>0}},{key:"ngControl",get:function(){return this._ngControl}},{key:"errorState",get:function(){return!!(this.ngControl&&this.ngControl.touched&&(this.ngControl.invalid||this.required&&this.empty))}},{key:"value",get:function(){return this.selectedMentionables.map((function(e){return e.hash}))}},{key:"setDescribedByIds",value:function(e){}},{key:"onContainerClick",value:function(e){}},{key:"ngOnInit",value:function(){var e,t=this;this._ngControl=this._injector.get(y.s),null!=this._ngControl&&(this._ngControl.valueAccessor=this),this.fm.monitor(null===(e=this.inputElement)||void 0===e?void 0:e.nativeElement).subscribe((function(e){return requestAnimationFrame((function(){t._focused=null!==e,t.cdr.markForCheck()}))}))}},{key:"ngOnDestroy",value:function(){this._optionsSub&&(this._optionsSub.unsubscribe(),delete this._optionsSub)}},{key:"focusInput",value:function(){var e;(null===(e=this.inputElement)||void 0===e?void 0:e.nativeElement)&&this.fm.focusVia(this.inputElement.nativeElement,"program")}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.selectedMentionables=[],e&&this.selectedMentionablesChange.emit(this.selectedMentionables)}},{key:"setFromStringArray",value:function(n){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(E.a)(this,void 0,void 0,t().mark((function o(){var r,a,s,c,l;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.clear(),r=[],a=e(n),t.prev=3,a.s();case 5:if((s=a.n()).done){t.next=13;break}return c=s.value,t.next=9,this.mentionsService.getMentionable(c).pipe(Object(ce.a)()).toPromise();case 9:(l=t.sent)&&(r.push(l),this.selectedMentionables.push(l),this.cdr.markForCheck());case 11:t.next=5;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),a.e(t.t0);case 18:return t.prev=18,a.f(),t.finish(18);case 21:i&&this.selectedMentionablesChange.emit(this.selectedMentionables);case 22:case"end":return t.stop()}}),o,this,[[3,15,18,21]])})))}},{key:"registerOnChange",value:function(e){this._onChange=e}},{key:"registerOnTouched",value:function(e){this._onTouched=e}},{key:"writeValue",value:function(e){null===e?this.clear():Array.isArray(e)?this.setFromStringArray(e):(console.warn("Invalid write value to mg-mentionable-select:",e),this.clear())}},{key:"_onFocus",value:function(){this.focusInput()}},{key:"_onClick",value:function(){this.focusInput()}},{key:"_onResize",value:function(){var e=this;requestAnimationFrame((function(){return e._repositionOptionsContainer()}))}},{key:"_onScroll",value:function(){var e=this;this.focused&&requestAnimationFrame((function(){return e._repositionOptionsContainer()}))}},{key:"_resizeInputElement",value:function(){var e,t,n=this,i=null===(e=this.inputElement)||void 0===e?void 0:e.nativeElement,o=null===(t=this.inputMeasurePlaceholder)||void 0===t?void 0:t.nativeElement;if(i&&o){var r=getComputedStyle(o);i.style.width=parseInt(r.width)+10+"px",requestAnimationFrame((function(){return n._repositionOptionsContainer()}))}}},{key:"_repositionOptionsContainer",value:function(){var e,t,n=null===(e=this.mentionableOptionsContainer)||void 0===e?void 0:e.nativeElement;if(n){var i=null===(t=this.inputElement)||void 0===t?void 0:t.nativeElement;if(i){var o=document.body.getBoundingClientRect(),r=i.getBoundingClientRect();n.style.transform="",n.style.left="".concat(r.right,"px"),n.style.top=r.top-o.top+"px",n.getBoundingClientRect().right>innerWidth&&(n.style.left="100vw",n.style.transform="translateX(-100%)",n.style.top=r.bottom-o.top+"px")}}}},{key:"_removeSelected",value:function(e){this.selectedMentionables.splice(e,1),this.selectedMentionablesChange.emit(this.selectedMentionables),this._onChange&&this._onChange(this.selectedMentionables),this.cdr.markForCheck()}},{key:"_onSearchTextChange",value:function(e){var t=this;this._searchText$.next(e),this._optionsSub||(this._optionsSub=this.searchTextDebounced$.pipe(Object(le.a)((function(e){return t.mentionsService.findMentionables(e,t.options)}))).subscribe((function(e){t.allowDuplicates||(e=e.filter((function(e){return-1===t.selectedMentionables.findIndex((function(t){return t.hash===e.hash}))}))),t._options=e.slice(0,5),t.cdr.markForCheck(),requestAnimationFrame((function(){return t._repositionOptionsContainer()}))}))),e||(this._optionsSub&&(this._optionsSub.unsubscribe(),delete this._optionsSub),this._options=[],this._highlightedOption=-1,this.cdr.markForCheck()),requestAnimationFrame((function(){return t._resizeInputElement()}))}},{key:"_onSearchKeypress",value:function(e){if(this._searchText)switch(e.key){case"Tab":case"Enter":e.preventDefault(),e.stopPropagation(),this._selectHighlightedOption();break;case"ArrowUp":e.preventDefault(),e.stopPropagation(),this._highlightOptionUp();break;case"ArrowDown":this._highlightOptionDown(),e.preventDefault(),e.stopPropagation()}}},{key:"_highlightOptionUp",value:function(){this._highlightedOption=Math.max(0,this._highlightedOption-1),this.cdr.markForCheck()}},{key:"_highlightOptionDown",value:function(){this._highlightedOption=Math.min(this._options.length-1,this._highlightedOption+1),this.cdr.markForCheck()}},{key:"_selectHighlightedOption",value:function(){var e=Math.max(0,this._highlightedOption);this._options[e]&&this._selectOption(this._options[e])}},{key:"_selectOption",value:function(e){this.selectedMentionables.push(e),this._options=[],this._highlightedOption=-1,this._searchText="",this.cdr.markForCheck(),this.selectedMentionablesChange.emit(this.selectedMentionables),this._onChange&&this._onChange(this.selectedMentionables)}}]),n}()).\u0275fac=function(e){return new(e||be)(d["\u0275\u0275directiveInject"](ie.b),d["\u0275\u0275directiveInject"](d.ChangeDetectorRef),d["\u0275\u0275directiveInject"](U.h),d["\u0275\u0275directiveInject"](d.Injector),d["\u0275\u0275directiveInject"](b.d,8))},be.\u0275cmp=d["\u0275\u0275defineComponent"]({type:be,selectors:[["mg-mentionable-select"]],viewQuery:function(e,t){var n;1&e&&(d["\u0275\u0275viewQuery"](ue,1),d["\u0275\u0275viewQuery"](he,3),d["\u0275\u0275viewQuery"](de,3)),2&e&&(d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.mentionableOptionsContainer=n.first),d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.inputElement=n.first),d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.inputMeasurePlaceholder=n.first))},hostBindings:function(e,t){1&e&&d["\u0275\u0275listener"]("focus",(function(){return t._onFocus()}))("click",(function(){return t._onClick()}))("resize",(function(){return t._onResize()}),!1,d["\u0275\u0275resolveWindow"])("scroll",(function(){return t._onScroll()}),!1,d["\u0275\u0275resolveWindow"])},inputs:{selectedMentionables:"selectedMentionables",allowDuplicates:"allowDuplicates",options:"options",required:"required",placeholder:"placeholder",disabled:"disabled",uneditableMentions:"uneditableMentions"},outputs:{selectedMentionablesChange:"selectedMentionablesChange"},features:[d["\u0275\u0275ProvidersFeature"]([we])],decls:9,vars:3,consts:[[1,"mg-mentionable-select-inner"],["class","mentionable-options-container",3,"display",4,"globalFloatingPortal"],["class","mg-mentionable-select-mat-chip",3,"removable","selectable","removed",4,"ngFor","ngForOf"],[1,"search-input","measure-placeholder"],["inputMeasurePlaceholder",""],["type","text","maxlength","32",1,"search-input",3,"ngModel","keydown","ngModelChange"],["inputElement",""],[1,"mentionable-options-container"],["mentionableOptionsContainer",""],["class","mentionable-option","fxLayout","row","fxLayoutAlign","start center",3,"highlighted","click","mousedown",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center",1,"mentionable-option",3,"click","mousedown"],["class","mentionable-img",3,"background-image",4,"ngIf"],["fxFlex","auto"],[1,"mentionable-img"],[1,"mg-mentionable-select-mat-chip",3,"removable","selectable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""]],template:function(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"label",0),d["\u0275\u0275template"](1,ge,3,3,"div",1),d["\u0275\u0275elementStart"](2,"mat-chip-list"),d["\u0275\u0275template"](3,ve,3,4,"mat-chip",2),d["\u0275\u0275elementStart"](4,"span",3,4),d["\u0275\u0275text"](6),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](7,"input",5,6),d["\u0275\u0275listener"]("keydown",(function(e){return t._onSearchKeypress(e)}))("ngModelChange",(function(e){return t._searchText=e}))("ngModelChange",(function(e){return t._onSearchTextChange(e)})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()),2&e&&(d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngForOf",t.selectedMentionables),d["\u0275\u0275advance"](3),d["\u0275\u0275textInterpolate"](t._searchText),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngModel",t._searchText))},directives:[w,C.c,h.n,y.d,y.n,y.t,y.w,V.e,V.d,h.o,V.b,C.a,_.a,C.d],styles:['@import url("https://fonts.googleapis.com/css?family=Muli:400,700,900");.mg-mentionable-select-inner[_ngcontent-%COMP%]{margin:8px 0}mat-chip.mg-mentionable-select-mat-chip[_ngcontent-%COMP%]{min-height:25px;margin-right:4px;font-family:Muli,sans-serif;line-height:1.35}@media (orientation:landscape){mat-chip.mg-mentionable-select-mat-chip[_ngcontent-%COMP%]{font-size:2.8985507246vh}}@media (orientation:portrait){mat-chip.mg-mentionable-select-mat-chip[_ngcontent-%COMP%]{font-size:2.8985507246vw}}@media (orientation:landscape) and (max-height:414px){mat-chip.mg-mentionable-select-mat-chip[_ngcontent-%COMP%]{font-size:12px}}@media (orientation:portrait) and (max-width:414px){mat-chip.mg-mentionable-select-mat-chip[_ngcontent-%COMP%]{font-size:12px}}@media (min-width:448.5px){mat-chip.mg-mentionable-select-mat-chip[_ngcontent-%COMP%]{font-size:13px}}.mentionable-options-container[_ngcontent-%COMP%]{position:absolute;background:#fff 0 0 no-repeat padding-box;box-shadow:0 0 6px rgba(0,0,0,.1607843137254902);border:1px solid #ccc;border-radius:4px;padding:4px 0}.mentionable-options-container[_ngcontent-%COMP%]   .mentionable-option[_ngcontent-%COMP%]{white-space:nowrap;padding:4px 16px;cursor:pointer;font-family:Muli,sans-serif;line-height:1.35}@media (orientation:landscape){.mentionable-options-container[_ngcontent-%COMP%]   .mentionable-option[_ngcontent-%COMP%]{font-size:2.8985507246vh}}@media (orientation:portrait){.mentionable-options-container[_ngcontent-%COMP%]   .mentionable-option[_ngcontent-%COMP%]{font-size:2.8985507246vw}}@media (orientation:landscape) and (max-height:414px){.mentionable-options-container[_ngcontent-%COMP%]   .mentionable-option[_ngcontent-%COMP%]{font-size:12px}}@media (orientation:portrait) and (max-width:414px){.mentionable-options-container[_ngcontent-%COMP%]   .mentionable-option[_ngcontent-%COMP%]{font-size:12px}}@media (min-width:448.5px){.mentionable-options-container[_ngcontent-%COMP%]   .mentionable-option[_ngcontent-%COMP%]{font-size:13px}}.mentionable-options-container[_ngcontent-%COMP%]   .mentionable-option[_ngcontent-%COMP%]   .mentionable-img[_ngcontent-%COMP%]{min-width:16px;max-width:16px;height:16px;border-radius:50%;margin-right:6px;background-color:#fff;background-position:50%;background-size:cover;border:1px solid #ccc;box-sizing:border-box}.mentionable-options-container[_ngcontent-%COMP%]   .mentionable-option.highlighted[_ngcontent-%COMP%], .mentionable-options-container[_ngcontent-%COMP%]   .mentionable-option[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.mentionable-options-container[_ngcontent-%COMP%]:hover.highlighted{background-color:unset}.search-input[_ngcontent-%COMP%]{background-color:initial;display:inline-block;border:0;padding:0;margin:0;min-width:1em;min-width:1ch;outline:none}.search-input.measure-placeholder[_ngcontent-%COMP%]{position:absolute;opacity:0;-webkit-user-select:none;user-select:none;pointer-events:none}'],changeDetection:0}),be),Me=((ye=c((function e(){a(this,e)}))).\u0275fac=function(e){return new(e||ye)},ye.\u0275mod=d["\u0275\u0275defineNgModule"]({type:ye}),ye.\u0275inj=d["\u0275\u0275defineInjector"]({imports:[[ie.a,k,h.c,y.m,C.e,_.b,p.a]]}),ye),Ee=s("EBcp"),Pe=s("HxU+"),Se=s("ls3q"),je=s("jaBy"),Fe=s("JVed"),Ie=s("HSxi"),He=s("cEQe"),Te=s("i1AJ"),Ae=s("8p1t"),Le=["form"],Ge=function(){return{searchPeople:!0}},De=function(){return{searchGroups:!0}},ze=function(){return{searchEvents:!0}},qe=["*"],Re=((_e=function(){function n(e,t,i){a(this,n),this.eventsFacade=e,this.groupsFacade=t,this.cdr=i,this._data={imageAssets:[],description:"",taggedGroups:[],taggedPeople:[],taggedContent:[]},this.uneditableEventContentHashes=[],this.uneditableGroupHashes=[],this.showSingleImage=!1,this.statusChanges=new d.EventEmitter,this.taggedMentionableHashes=[],this.taggedGroupHashes=[],this.taggedContentHashes=[],this.dataChanges=new d.EventEmitter}return c(n,[{key:"data",get:function(){return this._data}},{key:"valid",get:function(){var e;return(null===(e=this.form)||void 0===e?void 0:e.valid)||!1}},{key:"invalid",get:function(){return!this.valid}},{key:"_preselectedEventContextHashses",set:function(e){this._applyPreselectedEventContextHashes(e)}},{key:"_preselectedGroupHashes",set:function(e){this._applyPreselectedGroupHashes(e)}},{key:"_applyPreselectedEventContextHashes",value:function(n){return Object(E.a)(this,void 0,void 0,t().mark((function i(){var o,r,a,s,c,l;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.length){t.next=25;break}return t.next=3,this.eventsFacade.fetchEventCollectionIfNeeded();case 3:o=[],r=e(n),t.prev=5,r.s();case 7:if((a=r.n()).done){t.next=15;break}return s=a.value,t.next=11,this.eventsFacade.getEventByContextHash(s).pipe(Object(ce.a)()).toPromise();case 11:(c=t.sent)&&o.push(c.hash);case 13:t.next=7;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(5),r.e(t.t0);case 20:return t.prev=20,r.f(),t.finish(20);case 23:l=S.union(this._data.taggedContent,o),this._data.taggedContent=l,this.taggedContentHashes=l,this.uneditableEventContentHashes=o,this.dataChanges.emit(this._data),this.cdr.markForCheck();case 25:case"end":return t.stop()}}),i,this,[[5,17,20,23]])})))}},{key:"_applyPreselectedGroupHashes",value:function(e){return Object(E.a)(this,void 0,void 0,t().mark((function n(){var i,o,r;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.length&&(this.groupsFacade.dispatchLoadAll(),i=e.map((function(e){return e.hash})),o=e.filter((function(e){return e.immutable})).map((function(e){return e.hash})),r=S.union(this._data.taggedGroups,i),this._data.taggedGroups=r,this.taggedGroupHashes=r,this.uneditableGroupHashes=o,this.dataChanges.emit(this._data),this.cdr.markForCheck());case 1:case"end":return t.stop()}}),n,this)})))}},{key:"onTaggedMentionablesChange",value:function(e){this._data.taggedPeople=e.map((function(e){return e.hash})),this.dataChanges.emit(this._data)}},{key:"onTaggedGroupsChange",value:function(e){this._data.taggedGroups=e.map((function(e){return e.hash})),this.dataChanges.emit(this._data)}},{key:"onTaggedContentChange",value:function(e){this._data.taggedContent=e.map((function(e){return e.hash})),this.dataChanges.emit(this._data)}},{key:"setData",value:function(e){this._data=Object.assign({},e)}},{key:"ngOnInit",value:function(){return Object(E.a)(this,void 0,void 0,t().mark((function e(){var n=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.form&&this.form.statusChanges&&this.form.statusChanges.subscribe((function(e){n.statusChanges.next(e)})),e.next=3,this.eventsFacade.fetchEventCollectionIfNeeded();case 3:case"end":return e.stop()}}),e,this)})))}},{key:"getSingleImagePreviewUrl",value:function(){if(this.data.imageAssets.length>0){var e=this.data.imageAssets[0];return Object(je.b)(e)}return""}},{key:"onImageAssetsChange",value:function(e){}}]),n}()).\u0275fac=function(e){return new(e||_e)(d["\u0275\u0275directiveInject"](Fe.a),d["\u0275\u0275directiveInject"](Ie.b),d["\u0275\u0275directiveInject"](d.ChangeDetectorRef))},_e.\u0275cmp=d["\u0275\u0275defineComponent"]({type:_e,selectors:[["mg-add-gallery-photo-form"]],viewQuery:function(e,t){var n;1&e&&d["\u0275\u0275viewQuery"](Le,3),2&e&&d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.form=n.first)},inputs:{_preselectedEventContextHashses:["preselectedEventContextHashses","_preselectedEventContextHashses"],_preselectedGroupHashes:["preselectedGroupHashes","_preselectedGroupHashes"]},outputs:{statusChanges:"statusChanges",dataChanges:"dataChanges"},ngContentSelectors:qe,decls:35,vars:17,consts:[["form","ngForm"],[1,"file-input-upload-many-wrap"],["name","imageAssets",3,"required","ngModel","ngModelChange","mgModelStatusChanges"],["uploadMany",""],[1,"section"],["mgFormField",""],["name","description","maxlength","512",3,"ngModel","ngModelChange"],["align","end"],["name","taggedMentionables",3,"options","ngModel","selectedMentionablesChange","ngModelChange"],["name","taggedGroups",3,"options","uneditableMentions","ngModel","selectedMentionablesChange","ngModelChange"],["name","taggedContent",3,"options","uneditableMentions","ngModel","selectedMentionablesChange","ngModelChange"]],template:function(e,t){if(1&e&&(d["\u0275\u0275projectionDef"](),d["\u0275\u0275elementStart"](0,"form",null,0),d["\u0275\u0275elementStart"](2,"div",1),d["\u0275\u0275elementStart"](3,"mg-file-input-upload-many",2,3),d["\u0275\u0275listener"]("ngModelChange",(function(e){return t._data.imageAssets=e}))("ngModelChange",(function(e){return t.onImageAssetsChange(e)}))("mgModelStatusChanges",(function(){return t.onImageAssetsChange(t._data.imageAssets)})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](5,"div",4),d["\u0275\u0275elementStart"](6,"mat-form-field",5),d["\u0275\u0275elementStart"](7,"mat-label"),d["\u0275\u0275text"](8,"Description"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](9,"mg-textarea",6),d["\u0275\u0275listener"]("ngModelChange",(function(e){return t._data.description=e})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](10,"mat-hint",7),d["\u0275\u0275text"](11),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](12,"div",4),d["\u0275\u0275elementStart"](13,"mat-form-field",5),d["\u0275\u0275elementStart"](14,"mat-label"),d["\u0275\u0275text"](15,"Tag People"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](16,"mg-mentionable-select",8),d["\u0275\u0275listener"]("selectedMentionablesChange",(function(e){return t.onTaggedMentionablesChange(e)}))("ngModelChange",(function(e){return t.taggedMentionableHashes=e})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](17,"mat-hint"),d["\u0275\u0275text"](18,"Type any name"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](19,"div",4),d["\u0275\u0275elementStart"](20,"mat-form-field",5),d["\u0275\u0275elementStart"](21,"mat-label"),d["\u0275\u0275text"](22,"Tag Group(s)"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](23,"mg-mentionable-select",9),d["\u0275\u0275listener"]("selectedMentionablesChange",(function(e){return t.onTaggedGroupsChange(e)}))("ngModelChange",(function(e){return t.taggedGroupHashes=e})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](24,"mat-hint"),d["\u0275\u0275text"](25,"Type any group"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](26,"div",4),d["\u0275\u0275elementStart"](27,"mat-form-field",5),d["\u0275\u0275elementStart"](28,"mat-label"),d["\u0275\u0275text"](29,"Tag Event(s)"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](30,"mg-mentionable-select",10),d["\u0275\u0275listener"]("selectedMentionablesChange",(function(e){return t.onTaggedContentChange(e)}))("ngModelChange",(function(e){return t.taggedContentHashes=e})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](31,"mat-hint"),d["\u0275\u0275text"](32,"Type any event"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](33,"div",4),d["\u0275\u0275projection"](34),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275reference"](4);d["\u0275\u0275advance"](2),d["\u0275\u0275classProp"]("no-images",!(null!=n&&n.files.length)),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("required",!0)("ngModel",t._data.imageAssets),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("ngModel",t._data.description),d["\u0275\u0275advance"](2),d["\u0275\u0275textInterpolate1"]("",t._data.description.length," / 512"),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("options",d["\u0275\u0275pureFunction0"](14,Ge))("ngModel",t.taggedMentionableHashes),d["\u0275\u0275advance"](7),d["\u0275\u0275property"]("options",d["\u0275\u0275pureFunction0"](15,De))("uneditableMentions",t.uneditableGroupHashes)("ngModel",t.taggedGroupHashes),d["\u0275\u0275advance"](7),d["\u0275\u0275property"]("options",d["\u0275\u0275pureFunction0"](16,ze))("uneditableMentions",t.uneditableEventContentHashes)("ngModel",t.taggedContentHashes)}},directives:[y.E,y.u,y.v,He.a,y.B,y.t,y.w,b.d,Te.a,b.h,Ae.a,y.n,b.g,ke],styles:["[_nghost-%COMP%]{display:block}.section[_ngcontent-%COMP%]{margin:16px}.file-input-upload-many-wrap.no-images[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:6px;margin:16px 16px 0}"],changeDetection:0}),_e),Ne=((Ce=c((function e(){a(this,e)}))).\u0275fac=function(e){return new(e||Ce)},Ce.\u0275mod=d["\u0275\u0275defineNgModule"]({type:Ce}),Ce.\u0275inj=d["\u0275\u0275defineInjector"]({imports:[[ne.a,v.b,Ee.a,Se.a,Pe.a,Me,te,h.c,y.m,b.f]]}),Ce),Ue=s("PLeU"),Ve=s("txl0"),Qe=s("jNxq"),$e=s("GFah"),Be=s("SYVq"),We=s("4avL"),Je=["form"],Ke=function(e){return[e]},Xe=((xe=function(){function e(t,n,i,o,r,s,c,l){var u=this;a(this,e),this.router=t,this.galleryService=n,this.streamManager=i,this.rootService=o,this.route=r,this.cdr=s,this._location=c,this.groupsFacade=l,this.immutableEventContextHash="",this.immutableGroupHash="",this.groupHashes=[],this.route.params.subscribe((function(e){e.eventContextHash&&(u.immutableEventContextHash=e.eventContextHash,u.cdr.markForCheck()),e.groupHash&&(u.groupHashes.push({hash:e.groupHash,immutable:!0}),u.cdr.markForCheck())}))}return c(e,[{key:"ngOnInit",value:function(){this._checkDistrictEnabled()}},{key:"_checkDistrictEnabled",value:function(){return Object(E.a)(this,void 0,void 0,t().mark((function e(){var i,o,r,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.groupsFacade.getParentGroupHashes();case 2:if(i=e.sent,1!==this.groupHashes.length){e.next=8;break}return e.next=6,this.groupsFacade.getGroup(this.groupHashes[0].hash).pipe(Object(ce.a)()).toPromise();case 6:(null==(o=e.sent)?void 0:o.parentGroupHash)?i=[o.parentGroupHash]:(null==o?void 0:o.isParent)&&(i=[]);case 8:i&&(r=n(this.groupHashes),a=r.map((function(e){return e.hash})),i.forEach((function(e){a.includes(e)||r.push({hash:e,immutable:!1})})),this.groupHashes=r);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"_submit",value:function(e){return Object(E.a)(this,void 0,void 0,t().mark((function n(){var i;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.galleryService.addPhoto(e);case 2:return t.next=4,this.streamManager.restartStreamIfAvailable("GalleryFeed");case 4:return i=["/gallery"],this.immutableEventContextHash?(i.push("event"),i.push(this.immutableEventContextHash)):this.immutableGroupHash&&(i.push("group"),i.push(this.immutableGroupHash)),t.next=8,this.router.navigate(i);case 8:return t.next=10,Object(Ue.a)(this.router);case 10:case"end":return t.stop()}}),n,this)})))}},{key:"submit",value:function(e){return Object(E.a)(this,void 0,void 0,t().mark((function n(){return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.rootService.addLoadingPromise(this._submit(e));case 2:case"end":return t.stop()}}),n,this)})))}},{key:"cancel",value:function(){return Object(E.a)(this,void 0,void 0,t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.immutableEventContextHash){e.next=4;break}this._location.back(),e.next=6;break;case 4:return e.next=6,Object(Ue.a)(this.router);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"onFormStatusChanges",value:function(e){this.updateOverlayNext()}},{key:"updateOverlayNext",value:function(){this._onOverlayNextUpdate&&this._onOverlayNextUpdate(this.hasOverlayNext())}},{key:"updateOverlayPrevious",value:function(){this._onOverlayPreviousUpdate&&this._onOverlayPreviousUpdate(this.hasOverlayPrevious())}},{key:"onOverlayNext",value:function(){var e;return Object(E.a)(this,void 0,void 0,t().mark((function n(){return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===(e=this.form)||void 0===e?void 0:e.data,!t.t0){t.next=4;break}return t.next=4,this.submit(this.form.data);case 4:case"end":return t.stop()}}),n,this)})))}},{key:"onOverlayPrevious",value:function(){return Object(E.a)(this,void 0,void 0,t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cancel();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"hasOverlayNext",value:function(){return{icon:"publish-o",text:"Publish",disabled:!this.form||this.form.invalid}}},{key:"hasOverlayPrevious",value:function(){return{icon:"back",text:"Cancel"}}},{key:"registerOnOverlayConfig",value:function(e){e({})}},{key:"registerOnOverlayPreviousUpdate",value:function(e){this._onOverlayPreviousUpdate=e}},{key:"registerOnOverlayNextUpdate",value:function(e){this._onOverlayNextUpdate=e}}]),e}()).\u0275fac=function(e){return new(e||xe)(d["\u0275\u0275directiveInject"](f.g),d["\u0275\u0275directiveInject"](Ve.a),d["\u0275\u0275directiveInject"](Qe.a),d["\u0275\u0275directiveInject"]($e.a),d["\u0275\u0275directiveInject"](f.a),d["\u0275\u0275directiveInject"](d.ChangeDetectorRef),d["\u0275\u0275directiveInject"](h.k),d["\u0275\u0275directiveInject"](Ie.b))},xe.\u0275cmp=d["\u0275\u0275defineComponent"]({type:xe,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&d["\u0275\u0275viewQuery"](Je,3),2&e&&d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.form=n.first)},decls:9,vars:6,consts:[[3,"component"],[3,"preselectedEventContextHashses","preselectedGroupHashes","statusChanges"],["form",""],["fxLayout","row","fxLayoutGap","8px"],["fxFlex","auto"],["type","text",1,"normal",3,"click"],["type","outline",1,"normal",3,"disabled","click"]],template:function(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275element"](0,"mg-legacy-overlay-nav",0),d["\u0275\u0275elementStart"](1,"mg-add-gallery-photo-form",1,2),d["\u0275\u0275listener"]("statusChanges",(function(e){return t.onFormStatusChanges(e)})),d["\u0275\u0275elementStart"](3,"div",3),d["\u0275\u0275element"](4,"div",4),d["\u0275\u0275elementStart"](5,"mg-button",5),d["\u0275\u0275listener"]("click",(function(){return t.cancel()})),d["\u0275\u0275text"](6,"Cancel"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](7,"mg-button",6),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275reference"](2);return t.submit(e.data)})),d["\u0275\u0275text"](8,"Publish"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275reference"](2);d["\u0275\u0275property"]("component",t),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("preselectedEventContextHashses",d["\u0275\u0275pureFunction1"](4,Ke,t.immutableEventContextHash))("preselectedGroupHashes",t.groupHashes),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("disabled",i.invalid)}},directives:[Be.a,Re,V.e,V.f,V.b,We.a],styles:[""],changeDetection:0}),xe),Ye=[{path:"add",component:Xe},{path:"add/event/:eventContextHash",component:Xe},{path:"add/group/:groupHash",component:Xe}],Ze=((Oe=c((function e(){a(this,e)}))).\u0275fac=function(e){return new(e||Oe)},Oe.\u0275mod=d["\u0275\u0275defineNgModule"]({type:Oe}),Oe.\u0275inj=d["\u0275\u0275defineInjector"]({imports:[[Ne,g.a,v.b,m.a,h.c,f.k,p.a,f.k.forChild(Ye)]]}),Oe)}}])}();
//# sourceMappingURL=minga-app-src-app-routes-gallery-AddGalleryPhotoRoute-AddGalleryPhotoRoute-module-es5.js.map