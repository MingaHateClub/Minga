!function(){function e(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(!e)return;if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,r)}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){s=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(s)throw i}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,a=void 0,"symbol"==typeof(a=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"))?a:String(a)),n)}var o,a}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"8Vb0":function(t,n,a){"use strict";a.d(n,"a",(function(){return z}));var i=a("8Y7J"),l=a("HHVM"),s=a("Ac3E"),c=a("jtHE"),d=a("1G5W"),u=a("JcrP"),f=a("YgQ7"),p=a("TxG7"),g=a("31iK"),m=a("yEy8"),h=a("3qIc"),v=a("SYVq"),y=a("s7LF"),x=a("T0RT"),b=a("SVse"),k=a("VDRc"),S=a("4avL"),w=a("BTe0"),E=a("ura0"),C=a("Fudl"),P=a("5QHs"),I=a("cRkC"),F=["form"],O=["paginator"],R=["successOverlayTemplate"];function M(e,t){if(1&e){var r=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"mg-button",16),i["\u0275\u0275listener"]("click",(function(){return i["\u0275\u0275restoreView"](r),i["\u0275\u0275nextContext"](2).clear()})),i["\u0275\u0275text"](1,"Clear"),i["\u0275\u0275elementEnd"]()}}var T=function(e){return{opacity:e}};function L(e,t){if(1&e){var r=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div",12),i["\u0275\u0275elementStart"](1,"mg-button",13),i["\u0275\u0275listener"]("click",(function(){return i["\u0275\u0275restoreView"](r),i["\u0275\u0275nextContext"]().startUpload()})),i["\u0275\u0275text"](2),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](3,M,2,0,"mg-button",14),i["\u0275\u0275element"](4,"mat-progress-bar",15),i["\u0275\u0275elementEnd"]()}if(2&e){var n=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("disabled",n.hasErrorsFromParse||n.uploading),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"]("Create (",n.blockorderUploadRecords.length,")"),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!n.uploading),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngStyle",i["\u0275\u0275pureFunction1"](6,T,n.uploading?"1":"0"))("value",n.totalProgress)("bufferValue",n.totalBufferProgress)}}function U(e,t){if(1&e){var r=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"div"),i["\u0275\u0275elementStart"](1,"div",17),i["\u0275\u0275listener"]("click",(function(){i["\u0275\u0275restoreView"](r);var e=t.$implicit;return i["\u0275\u0275nextContext"]().goToError(e.recordIndex)})),i["\u0275\u0275elementStart"](2,"mg-icon"),i["\u0275\u0275text"](3,"warning-o"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"span",18),i["\u0275\u0275text"](5),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&e){var n=t.$implicit;i["\u0275\u0275advance"](1),i["\u0275\u0275classProp"]("selectable",n.recordIndex>-1),i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate"](n.errorMessage)}}var V=function(){return[5,10,25,100]};function j(e,t){if(1&e){var r=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"mat-paginator",19,20),i["\u0275\u0275listener"]("page",(function(e){return i["\u0275\u0275restoreView"](r),i["\u0275\u0275nextContext"]().onPageChange(e)})),i["\u0275\u0275elementEnd"]()}if(2&e){var n=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("length",n.blockorderUploadRecords.length)("pageSize",n.defaultPageSize)("pageSizeOptions",i["\u0275\u0275pureFunction0"](3,V))}}function A(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",27),i["\u0275\u0275elementStart"](1,"div",28),i["\u0275\u0275elementStart"](2,"mg-icon"),i["\u0275\u0275text"](3,"warning-o"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"span",18),i["\u0275\u0275text"](5),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){var r=t.$implicit;i["\u0275\u0275advance"](5),i["\u0275\u0275textInterpolate"](r)}}function _(e,t){if(1&e){var r=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"mg-button",29),i["\u0275\u0275listener"]("click",(function(){i["\u0275\u0275restoreView"](r);var e=i["\u0275\u0275nextContext"]().index;return i["\u0275\u0275nextContext"]().removeRecord(e)})),i["\u0275\u0275elementStart"](1,"mg-icon",30),i["\u0275\u0275text"](2,"warning-o"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"span",30),i["\u0275\u0275text"](4,"Remove"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}}function D(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",21),i["\u0275\u0275elementStart"](1,"div",22),i["\u0275\u0275elementStart"](2,"div"),i["\u0275\u0275text"](3),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"div",23),i["\u0275\u0275elementStart"](5,"span"),i["\u0275\u0275text"](6,"on\xa0"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](7,"strong"),i["\u0275\u0275text"](8),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](9,"div",24),i["\u0275\u0275elementStart"](10,"div",18),i["\u0275\u0275template"](11,A,6,1,"div",25),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](12,_,5,0,"mg-button",26),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){var r=t.$implicit,n=t.index,o=i["\u0275\u0275nextContext"]();i["\u0275\u0275classProp"]("blockorder-highlight",o.isDisplayHighlighted(n)),i["\u0275\u0275advance"](3),i["\u0275\u0275textInterpolate2"](" ",r.record.prefix," ",r.record.blockorder," "),i["\u0275\u0275advance"](5),i["\u0275\u0275textInterpolate"](o.displayRecordDate(r.record)),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngForOf",r.errors),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",r.errors.length>0)}}function B(e,t){if(1&e&&(i["\u0275\u0275elementStart"](0,"div",31),i["\u0275\u0275elementStart"](1,"div",32),i["\u0275\u0275element"](2,"mg-success-checkmark"),i["\u0275\u0275elementStart"](3,"div",33),i["\u0275\u0275text"](4),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()),2&e){var r=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](4),i["\u0275\u0275textInterpolate1"](" ",r.blockorderUploadRecords.length," records uploaded! ")}}var H={date:/date|time|when/gi,prefix:/prefix|before|text|/gi,blockorder:/blockorder|block|order|schedule|message|/gi},z=function(){var t=function(){function t(e,n,o,a,i){var l=this;r(this,t),this.mgModal=e,this.contentFeed=n,this.topOfFeed=o,this.routerDerivedState=a,this.mingaStore=i,this.files=[],this.errors=[],this.hasErrorsFromParse=!1,this.blockorderUploadRecords=[],this.displayBlockorderUploadRecords=[],this.uploading=!1,this.highlightIndex=-1,this.totalProgress=0,this.totalBufferProgress=0,this.defaultPageSize=10,this.groupHash=null,this.districtEnabled=!1,this._destroyed$=new c.a(1),this.routerDerivedState.currentGroup$.pipe(Object(d.a)(this._destroyed$)).subscribe((function(e){e&&e.hash&&(l.groupHash=e.hash)})),this.mingaStore.observeDistrictFeatureEnabled().pipe(Object(d.a)(this._destroyed$)).subscribe((function(e){return l.districtEnabled=e}))}return o(t,[{key:"ngOnDestroy",value:function(){this._destroyed$.next(),this._destroyed$.complete()}},{key:"parseColumnName",value:function(e){var t=0,r="";for(var n in H){var o=e.match(H[n]);o&&((o=o.filter((function(e){return!!e}))).length>t&&(t=o.length,r=n))}return r}},{key:"parseData",value:function(e){for(var t=this,r=e[0].map((function(e){return t.parseColumnName(e)})),n=e.slice(1),o=function(){var e=n[a],o={};r.forEach((function(t,r){var n=e[r];n&&t&&(o[t]=n)}));var i=[];if(i.length>0){t.hasErrorsFromParse=!0;var l;l=1==i.length?i[0]:"Multiple (".concat(i.length,") errors for record"),t.errors.push({recordIndex:t.blockorderUploadRecords.length,errorMessage:l})}t.blockorderUploadRecords.push({record:o,errors:i,progress:0,highlight:!1})},a=0;n.length>a;a++)o();this.blockorderUploadRecords=this.blockorderUploadRecords.filter((function(e){return e.record.blockorder||e.record.prefix})),this.onPageChange({pageIndex:0,pageSize:this.defaultPageSize})}},{key:"displayRecordDate",value:function(e){return Object(l.day)(e.date).format("MMM Do YYYY")}},{key:"clear",value:function(){this.displayBlockorderUploadRecords=[],this.blockorderUploadRecords=[],this.clearErrorsAndProgress()}},{key:"clearErrorsAndProgress",value:function(){this.errors=[],this.totalBufferProgress=0,this.totalProgress=0,this.hasErrorsFromParse=!1,this.clearHighlights(),this.blockorderUploadRecords.forEach((function(e){e.errors=[],e.progress=0}))}},{key:"clearHighlights",value:function(){this.highlightIndex=-1}},{key:"onPageChange",value:function(e){var t=e.pageIndex,r=e.pageSize;this.displayBlockorderUploadRecords=this.blockorderUploadRecords.slice(t*r,t*r+r)}},{key:"isDisplayHighlighted",value:function(e){return!!this.paginator&&this.paginator.pageIndex*this.paginator.pageSize+e===this.highlightIndex}},{key:"parseFile",value:function(e){var t=this,r=new FileReader;r.onloadend=function(e){var n=u.a(r.result,{type:"array"});if(n.Sheets)for(var o in n.Sheets){var a=u.b.sheet_to_json(n.Sheets[o],{header:1,blankrows:!1,raw:!1});t.parseData(a)}},r.readAsArrayBuffer(e)}},{key:"filesChange",value:function(){var t,r=e(this.files);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.parseFile(n)}}catch(o){r.e(o)}finally{r.f()}}},{key:"startUpload",value:function(){var e=this,t=new s.AddTopOfFeedTextRequest;this.districtEnabled&&this.groupHash&&t.setGrouphash(this.groupHash),this.errors=[],this.totalBufferProgress=0,this.totalProgress=0,this.clearErrorsAndProgress(),this.blockorderUploadRecords.forEach((function(e){var r=new s.TopOfFeedText;r.setPrefix(e.record.prefix||""),r.setText(e.record.blockorder||"");var n=l.day.utc(e.record.date).toDate();r.setTimestamp(n.getTime()),t.addTopOfFeedText(r)}));var r=this.contentFeed.addTopOfFeedText(t);this.uploading=!0;var n=!1;r.subscribe((function(t){e.totalProgress=Math.max(e.totalProgress,100*t.getTotalProgress());var r=e.blockorderUploadRecords[t.getIndex()];if(r&&(r.progress=100*t.getProgress()),t.hasError()){n=!0;var o=t.getError(),a=o.getIndex();if(a>-1){var i=e.blockorderUploadRecords[a];i&&(i.errors.push(o.getMessage()),e.errors.push({recordIndex:t.getIndex(),errorMessage:o.getMessage()}))}else e.errors.push({recordIndex:-1,errorMessage:o.getMessage()})}}),(function(t){console.error(t),e.uploading=!1}),(function(){if(!n){var t=e.mgModal.open(e.successOverlayTemplate,{full:!0,animation:"fade"});setTimeout((function(){e.clear(),t.close()}),2e3)}e.uploading=!1,e.topOfFeed.invalidateTopOfFeedCache()}))}},{key:"goToError",value:function(e){}},{key:"removeRecord",value:function(e){}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i["\u0275\u0275directiveInject"](f.b),i["\u0275\u0275directiveInject"](p.ContentFeed),i["\u0275\u0275directiveInject"](g.a),i["\u0275\u0275directiveInject"](m.a),i["\u0275\u0275directiveInject"](h.b))},t.\u0275cmp=i["\u0275\u0275defineComponent"]({type:t,selectors:[["mg-admin-blockorder"]],viewQuery:function(e,t){var r;(1&e&&(i["\u0275\u0275viewQuery"](F,3),i["\u0275\u0275viewQuery"](O,3),i["\u0275\u0275viewQuery"](R,3)),2&e)&&(i["\u0275\u0275queryRefresh"](r=i["\u0275\u0275loadQuery"]())&&(t.form=r.first),i["\u0275\u0275queryRefresh"](r=i["\u0275\u0275loadQuery"]())&&(t.paginator=r.first),i["\u0275\u0275queryRefresh"](r=i["\u0275\u0275loadQuery"]())&&(t.successOverlayTemplate=r.first))},decls:18,vars:7,consts:[[3,"component"],[1,"mg-centered"],[1,"hint-text"],["href","https://support.minga.io/knowledge/uploading-your-school-s-block-schedule-to-minga"],["name","bulkPeopleFileInput","multiple","","icon","list_file-o","compactIcon","list_file-o","accept",".csv, text/csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","friendlyName","CSV or Excel file",3,"ngModel","showFileDetails","ngModelChange"],["class","blockorder-records-list","fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","8px",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"length","pageSize","pageSizeOptions","page",4,"ngIf"],[1,"blockorder-list"],["blockorderList",""],["class","blockorder-record-wrap",3,"blockorder-highlight",4,"ngFor","ngForOf"],["successOverlayTemplate",""],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","8px",1,"blockorder-records-list"],[3,"disabled","click"],["class","clear-btn","type","outline",3,"click",4,"ngIf"],["fxFlex","","mode","buffer",1,"upload-progress",3,"ngStyle","value","bufferValue"],["type","outline",1,"clear-btn",3,"click"],["fxLayout","row","fxLayoutAlign","center center",1,"upload-error",3,"click"],["fxFlex",""],[3,"length","pageSize","pageSizeOptions","page"],["paginator",""],[1,"blockorder-record-wrap"],["fxLayout","column",1,"blockorder-record"],["fxLayout","row","fxFlex",""],["fxLayout","row","fxLayoutAlign","start top"],["class","blockorder-record-errors","ngClass.xs","no-margin",4,"ngFor","ngForOf"],["class","remove-record-btn","type","outline","fxLayout","row","fxLayoutAlign","center center",3,"click",4,"ngIf"],["ngClass.xs","no-margin",1,"blockorder-record-errors"],["fxLayout","row","fxLayoutAlign","center center",1,"upload-error"],["type","outline","fxLayout","row","fxLayoutAlign","center center",1,"remove-record-btn",3,"click"],[1,"vmid"],[1,"success-overlay"],[1,"checkmark-wrap"],[1,"mg-bodycopy"]],template:function(e,t){1&e&&(i["\u0275\u0275element"](0,"mg-legacy-overlay-nav",0),i["\u0275\u0275elementStart"](1,"h1",1),i["\u0275\u0275text"](2,"Daily Bulletin Upload"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"p",2),i["\u0275\u0275text"](4," Upload a small message for each day, to be displayed at the top of the home feed. This is often used for daily block schedules. "),i["\u0275\u0275elementStart"](5,"a",3),i["\u0275\u0275text"](6," See the helpdocs"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275text"](7," for more info on the format to use.\n"),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](8,"form"),i["\u0275\u0275elementStart"](9,"mg-file-input",4),i["\u0275\u0275listener"]("ngModelChange",(function(e){return t.files=e}))("ngModelChange",(function(){return t.filesChange()})),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](10,L,5,8,"div",5),i["\u0275\u0275template"](11,U,6,3,"div",6),i["\u0275\u0275template"](12,j,2,4,"mat-paginator",7),i["\u0275\u0275elementStart"](13,"div",8,9),i["\u0275\u0275template"](15,D,13,7,"div",10),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](16,B,5,1,"ng-template",null,11,i["\u0275\u0275templateRefExtractor"])),2&e&&(i["\u0275\u0275property"]("component",t),i["\u0275\u0275advance"](9),i["\u0275\u0275property"]("ngModel",t.files)("showFileDetails",!1),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",t.blockorderUploadRecords.length>0),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",t.errors),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",t.blockorderUploadRecords.length>0),i["\u0275\u0275advance"](3),i["\u0275\u0275property"]("ngForOf",t.displayBlockorderUploadRecords))},directives:[v.a,y.E,y.u,y.v,x.a,y.t,y.w,b.o,b.n,k.e,k.d,k.f,S.a,w.a,k.b,b.p,E.c,C.a,P.a,E.a,I.a],styles:[".blockorder-record[_ngcontent-%COMP%]{padding:8px;background-color:#fff;border-radius:6px;margin:8px 4px;box-shadow:0 0 4px rgba(0,0,0,.17)}.success-overlay[_ngcontent-%COMP%]{height:100%;text-align:center;position:relative}.success-overlay[_ngcontent-%COMP%]   .checkmark-wrap[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translateY(-50%) translateX(-50%)}.hint-text[_ngcontent-%COMP%]{width:90%;margin:auto}mat-paginator[_ngcontent-%COMP%]{margin:16px 0}.blockorder-list[_ngcontent-%COMP%], .blockorder-record[_ngcontent-%COMP%], .blockorder-records-list[_ngcontent-%COMP%]{padding:20px}"]}),t}()},LM9v:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n("SVse"),i=n("8Y7J"),l=n("u9T3"),s=n("s7LF"),c=n("5QHs"),d=n("BTe0"),u=n("CO6v"),f=n("9F0b"),p=n("eJkR"),g=n("ls3q"),m=n("CL15");n("8Vb0");var h=function(){var e=o((function e(){r(this,e)}));return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=i["\u0275\u0275defineInjector"]({imports:[[g.a,p.a,u.a,f.c,m.a,a.c,s.m,l.a,c.b,d.b]]}),e}()},sETV:function(e,t,n){"use strict";n.r(t),n.d(t,"AdminBlockOrderRoutesModule",(function(){return d}));var a=n("8Y7J"),i=n("iInd"),l=n("8Vb0"),s=n("LM9v"),c=[{path:"",component:l.a}],d=function(){var e=o((function e(){r(this,e)}));return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=a["\u0275\u0275defineInjector"]({imports:[[s.a,i.k.forChild(c)]]}),e}()}}])}();
//# sourceMappingURL=default~minga-app-src-app-routes-admin-AdminRoutes-module~minga-app-src-app-routes-admin-PeopleAdmin~5f09ade6-es5.js.map