!function(){function e(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e=function(){return t};var t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(E){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,a=Object.create(o.prototype),c=new I(r||[]);return i(a,"_invoke",{value:w(e,n,c)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(E){return{type:"throw",arg:E}}}t.wrap=u;var f={};function h(){}function p(){}function g(){}var m={};l(m,a,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(S([])));y&&y!==n&&r.call(y,a)&&(m=y);var b=g.prototype=h.prototype=Object.create(m);function C(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){var n;i(this,"_invoke",{value:function(i,o){function a(){return new t((function(n,a){!function n(i,o,a,c){var s=d(e[i],e,o);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}(i,o,n,a)}))}return n=n?n.then(a,a):a()}})}function w(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return _()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var c=k(a,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=d(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function k(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:_}}function _(){return{value:void 0,done:!0}}return p.prototype=g,i(b,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:p,configurable:!0}),p.displayName=l(g,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},C(x.prototype),l(x.prototype,c,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new x(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(b),l(b,s,"Generator"),l(b,a,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=S,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),s=r.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,"symbol"==typeof(o=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"))?o:String(o)),r)}var i,o}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{EPnd:function(e,t,n){"use strict";var r=n("egeQ");n.d(t,"a",(function(){return r.a}))},egeQ:function(n,i,o){"use strict";o.d(i,"a",(function(){return m}));var a=o("mrSG"),c=o("8Y7J"),s=o("+dib"),l=o("4doY"),u=o("Fawd"),d=o("6GgV"),f=o("Cnb3"),h=o("gEWx"),p=o("9szt"),g=o("TNy8"),m=function(){var n=function(){function n(e,r){t(this,n),this.challengeProto=e,this.bannerService=r}return r(n,[{key:"getContentInfo",value:function(t){return Object(a.a)(this,void 0,void 0,e().mark((function n(){var r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new l.ContentInfoQuery,e.abrupt("return",(r.setContentHash(t),this._makeContentInfoRequest(r)));case 2:case"end":return e.stop()}}),n,this)})))}},{key:"getContentInfoByContext",value:function(t){return Object(a.a)(this,void 0,void 0,e().mark((function n(){var r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new l.ContentInfoQuery,e.abrupt("return",(r.setContentContextHash(t),this._makeContentInfoRequest(r)));case 2:case"end":return e.stop()}}),n,this)})))}},{key:"_makeContentInfoRequest",value:function(t){return Object(a.a)(this,void 0,void 0,e().mark((function n(){var r,i,o,a,c,l,p,g,m,v,y,b,C,x,w,k,P;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.challengeProto.getInfo(t);case 2:if(r=e.sent,i=r.getTitle(),o=r.getBody(),a=Object(s.f)(r.getDueDate()),c=Object(h.$enum)(d.ChallengePrivacy).asValueOrThrow(r.getPrivacy()),l=r.getCommentsAllowed(),p=r.getBannerAsset(),g=Object(h.$enum)(d.ChallengeType).asValueOrThrow(r.getType()),m=Object(h.$enum)(d.ChallengeColor).asValueOrThrow(r.getColor()),v=r.getPointValue(),y=r.getBadgeAsset(),b=r.getAllowedRolesList().map((function(e){return Object(h.$enum)(f.MingaRoleType).asValueOrThrow(e)})),!r.getBannerHash()){e.next=20;break}return(w=new u.BannerLibraryGet).setBannerHash(r.getBannerHash()),e.next=19,this.bannerService.get(w);case 19:C=e.sent.toObject();case 20:if(!r.getBadgeHash()){e.next=26;break}return(k=new u.BannerLibraryGet).setBannerHash(r.getBadgeHash()),e.next=25,this.bannerService.get(k);case 25:x=e.sent.toObject();case 26:return P=r.getRequiresApproval(),e.abrupt("return",{title:i,body:o,dueDate:a,privacy:c,commentsAllowed:l,uploadedImage:p,banner:C,type:g,contentHash:r.getContentHash()||"",contextHash:r.getContextHash()||"",color:m,points:v,uploadedBadge:y,badge:x,allowedRoles:b,requiresApproval:P});case 28:case"end":return e.stop()}}),n,this)})))}}]),n}();return n.\u0275fac=function(e){return new(e||n)(c["\u0275\u0275inject"](p.Challenge),c["\u0275\u0275inject"](g.BannerLibrary))},n.\u0275prov=c["\u0275\u0275defineInjectable"]({token:n,factory:n.\u0275fac,providedIn:"root"}),n}()},"f14+":function(e,n,i){"use strict";i.d(n,"a",(function(){return k}));var o=i("SVse"),a=i("8Y7J"),c=i("u9T3"),s=i("s7LF"),l=i("pMoy"),u=i("Q2Ze"),d=i("CO6v"),f=i("mP6D"),h=i("ZOVA"),p=i("p+4T"),g=i("EBcp"),m=i("fHWq"),v=i("HxU+"),y=i("ppIK"),b=i("+/Hu"),C=i("CL15"),x=i("Vwx4"),w=i("Ogcz");i("rS4c");var k=function(){var e=r((function e(){t(this,e)}));return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=a["\u0275\u0275defineInjector"]({imports:[[d.a,C.a,m.a,y.a,x.b,g.a,w.b,v.a,b.a,p.a,f.a,h.a,o.c,c.a,u.f,l.b,s.m]]}),e}()},jxTo:function(e,n,i){"use strict";i.r(n),i.d(n,"ChallengeAnswerOverlayRoutingModule",(function(){return l}));var o=i("8Y7J"),a=i("iInd"),c=i("rS4c"),s=i("f14+"),l=function(){var e=r((function e(){t(this,e)}));return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({imports:[[s.a,a.k.forChild([{path:"",component:c.a}])]]}),e}()},mP6D:function(e,n,i){"use strict";i.d(n,"a",(function(){return p})),i("tcBv");var o,a=i("SVse"),c=i("8Y7J"),s=i("s7LF"),l=i("ugqS"),u=i("m9yI"),d=i("ls3q"),f=i("Ogcz"),h=i("E4Uz"),p=((o=r((function e(){t(this,e)}))).\u0275fac=function(e){return new(e||o)},o.\u0275mod=c["\u0275\u0275defineNgModule"]({type:o}),o.\u0275inj=c["\u0275\u0275defineInjector"]({imports:[[u.b,l.a,f.b,d.a,a.c,s.m,h.b]]}),o)},rS4c:function(n,i,o){"use strict";o.d(i,"a",(function(){return T}));var a=o("mrSG"),c=o("8Y7J"),s=o("PLeU"),l=o("6GgV"),u=o("jtHE"),d=o("1G5W"),f=o("lJxs"),h=o("iInd"),p=o("SVse"),g=o("zc8W"),m=o("EPnd"),v=o("uDiC"),y=o("BxgO"),b=o("md6V"),C=o("s7LF"),x=o("9sQ6"),w=o("uplL"),k=o("o1f5"),P=o("gjtd"),O=o("tcBv"),I=o("Jkk8"),S=["form"],_=["fileInputUpload"];function E(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"div"),c["\u0275\u0275elementStart"](1,"mg-overlay-nav-item",16),c["\u0275\u0275listener"]("click",(function(){return c["\u0275\u0275restoreView"](n),c["\u0275\u0275nextContext"]().onClose()})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}}function j(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"mg-clipped-html-tail"),c["\u0275\u0275elementStart"](1,"a",17),c["\u0275\u0275listener"]("click",(function(e){return c["\u0275\u0275restoreView"](n),c["\u0275\u0275nextContext"](),c["\u0275\u0275reference"](6).showFullHtmlClick(e)})),c["\u0275\u0275text"](2,"...More"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}}function D(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"mg-file-input-upload",18,19),c["\u0275\u0275listener"]("ngModelChange",(function(e){return c["\u0275\u0275restoreView"](n),c["\u0275\u0275nextContext"]().onFileUpload(e)}))("ngModelChange",(function(e){return c["\u0275\u0275restoreView"](n),c["\u0275\u0275nextContext"]().uploadedImage=e})),c["\u0275\u0275elementEnd"]()}if(2&e){var r=c["\u0275\u0275nextContext"]();c["\u0275\u0275property"]("showFileDetails",!1)("ngModel",r.uploadedImage)}}function M(e,t){if(1&e&&c["\u0275\u0275element"](0,"mg-avatar",20),2&e){var n=t.ngIf;c["\u0275\u0275property"]("src",n.profileImageUrl)("color",n.badgeIconColor)}}function B(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"div",21),c["\u0275\u0275elementStart"](1,"p",22),c["\u0275\u0275text"](2,"Add Background:"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](3,"mg-challenge-banner-library-stream",23),c["\u0275\u0275listener"]("selectedColorChange",(function(e){return c["\u0275\u0275restoreView"](n),c["\u0275\u0275nextContext"]().onColorSelected(e)}))("selectedBannerChange",(function(e){return c["\u0275\u0275restoreView"](n),c["\u0275\u0275nextContext"]().onBannerSelected(e)})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){var r=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("enableColorPicker",!0)("selectedColor",r.selectedColor)("selectedAssetId",r.selectedBanner)}}var T=function(){var n=function(){function n(e,r,i,o,a,c){var s=this;t(this,n),this.route=e,this.router=r,this._location=i,this.authInfo=o,this.contentInfoService=a,this.draftService=c,this.challengeType=l.ChallengeType.TEXT,this._destroyed$=new u.a(1),this.hasDraft=!1,this.public=!0,this.private=!1,this.answerText="",this.uploadedImage="",this.selectedColor="",this.challengePreviewLength=180,this.challengeIdSub=e.params.pipe(Object(d.a)(this._destroyed$),Object(f.a)((function(e){return e.challengeId}))).subscribe((function(e){s.challengeId=e,s.getChallengeInfo(e)})),this.currentUser$=this.authInfo.authInfo$.pipe(Object(d.a)(this._destroyed$),Object(f.a)((function(e){return e&&e.person?e.person:null})))}return r(n,[{key:"disabledSubmit",get:function(){var e,t=!1;return this.isImageChallengeType&&(t=!this.uploadedImage),(null===(e=this.form)||void 0===e?void 0:e.invalid)||!this.challenge||t}},{key:"isImageChallengeType",get:function(){return this.challengeType==l.ChallengeType.IMAGE}},{key:"_getPendingDraft",value:function(){var e,t;return{privacy:this.private?l.ChallengePrivacy.PRIVATE:l.ChallengePrivacy.PUBLIC,color:(null===(e=this.challenge)||void 0===e?void 0:e.color)||l.ChallengeColor.RED,body:this.answerText,banner:this.selectedBanner,backgroundColor:this.selectedColor,type:this.challengeType,asset:this.uploadedImage,ownerContextHash:(null===(t=this.challenge)||void 0===t?void 0:t.contextHash)||""}}},{key:"getChallengeInfo",value:function(t){return Object(a.a)(this,void 0,void 0,e().mark((function n(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.contentInfoService.getContentInfo(t);case 2:return this.challenge=e.sent,this.challengeType=this.challenge.type,e.next=6,this.initDraft();case 6:case"end":return e.stop()}}),n,this)})))}},{key:"initDraft",value:function(){var t;return Object(a.a)(this,void 0,void 0,e().mark((function n(){var r,i=this;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasDraft||!this.challengeId){e.next=6;break}return this.hasDraft=!0,e.next=4,this.draftService.getDraftDefaulted((null===(t=this.challenge)||void 0===t?void 0:t.contextHash)||"",(function(){return i.draftService.getDefaultResponse()}));case 4:(r=e.sent)&&(this.answerText=r.body,this.selectedColor=r.backgroundColor||"",this.private=r.privacy==l.ChallengePrivacy.PRIVATE,r.banner&&(this.selectedBanner=r.banner),r.asset&&(this.uploadedImage=r.asset));case 6:case"end":return e.stop()}}),n,this)})))}},{key:"onFileUpload",value:function(e){this.uploadedImage=window.MINGA_ASSET_URL_PREFIX+e,this.selectedBanner=void 0,this.selectedColor="",this.updateDraft()}},{key:"onPublicChange",value:function(){this.private=!1}},{key:"onPrivateChange",value:function(){this.public=!1}},{key:"onClose",value:function(){return Object(a.a)(this,void 0,void 0,e().mark((function t(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.draftService.cancelDraft();case 2:return e.next=4,Object(s.a)(this.router);case 4:case"end":return e.stop()}}),t,this)})))}},{key:"ngOnDestroy",value:function(){this._destroyed$.next(),this._destroyed$.complete()}},{key:"onBannerSelected",value:function(e){e&&(this.selectedBanner=e,this.selectedColor="",this.updateDraft())}},{key:"onColorSelected",value:function(e){this.selectedColor=e,this.selectedBanner=void 0,this.updateDraft()}},{key:"updateDraft",value:function(){var e=this._getPendingDraft();this.draftService.saveDraftDelayed(e)}},{key:"onSubmit",value:function(){return Object(a.a)(this,void 0,void 0,e().mark((function t(){var n;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.disabledSubmit){e.next=2;break}return e.abrupt("return");case 2:return n=this._getPendingDraft(),e.next=5,this.draftService.saveDraft(n);case 5:return e.next=7,this.router.navigate(["",{outlets:{o:["challenge~answer","preview",this.challengeId]}}]);case 7:case"end":return e.stop()}}),t,this)})))}}]),n}();return n.\u0275fac=function(e){return new(e||n)(c["\u0275\u0275directiveInject"](h.a),c["\u0275\u0275directiveInject"](h.g),c["\u0275\u0275directiveInject"](p.k),c["\u0275\u0275directiveInject"](g.a),c["\u0275\u0275directiveInject"](m.a),c["\u0275\u0275directiveInject"](v.a))},n.\u0275cmp=c["\u0275\u0275defineComponent"]({type:n,selectors:[["mg-challenge-answer-overlay"]],viewQuery:function(e,t){var n;(1&e&&(c["\u0275\u0275viewQuery"](S,3),c["\u0275\u0275viewQuery"](_,1)),2&e)&&(c["\u0275\u0275queryRefresh"](n=c["\u0275\u0275loadQuery"]())&&(t.form=n.first),c["\u0275\u0275queryRefresh"](n=c["\u0275\u0275loadQuery"]())&&(t.fileInputUpload=n.first))},decls:22,vars:17,consts:[[4,"mgOverlayStructure","mgOverlayStructureRegion"],[1,"challenge-info-header"],[1,"title",3,"innerHTML"],[1,"divider"],[3,"fullHtml","clippedLength"],["clippedBodyHtml",""],[4,"ngIf"],[1,"mg-bodycopy",3,"submit"],["form","ngForm"],["accept","image/*","customTitleText","Upload A Photo","previewAspectRatio","2:1","name","fileUpload",3,"showFileDetails","ngModel","ngModelChange",4,"ngIf"],[1,"header-container","mg-bodycopy-bold"],[3,"src","color",4,"ngIf"],["name","challengeBody","required","true","showRemainingCountTilMaxLength","true",1,"form-input-hpadding",3,"richContent","maxlength","ngModel","ngModelChange"],["class","background-selection-container",4,"ngIf"],[1,"footer","mg-minicopy"],["mgBubbleBtn","",3,"disabled"],["icon","close",1,"mg-align-left",3,"click"],["href","javascript:;",3,"click"],["accept","image/*","customTitleText","Upload A Photo","previewAspectRatio","2:1","name","fileUpload",3,"showFileDetails","ngModel","ngModelChange"],["fileInputUpload",""],[3,"src","color"],[1,"background-selection-container"],[1,"mg-minicopy"],["type","CHALLENGE_BG",3,"enableColorPicker","selectedColor","selectedAssetId","selectedColorChange","selectedBannerChange"]],template:function(e,t){if(1&e&&(c["\u0275\u0275template"](0,E,2,0,"div",0),c["\u0275\u0275elementStart"](1,"div",1),c["\u0275\u0275element"](2,"p",2),c["\u0275\u0275pipe"](3,"mgSafeHtml"),c["\u0275\u0275element"](4,"div",3),c["\u0275\u0275elementStart"](5,"mg-clipped-html",4,5),c["\u0275\u0275element"](7,"mg-clipped-html-head"),c["\u0275\u0275template"](8,j,3,0,"mg-clipped-html-tail",6),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"form",7,8),c["\u0275\u0275listener"]("submit",(function(){return t.onSubmit()})),c["\u0275\u0275template"](11,D,2,2,"mg-file-input-upload",9),c["\u0275\u0275elementStart"](12,"div",10),c["\u0275\u0275template"](13,M,1,2,"mg-avatar",11),c["\u0275\u0275pipe"](14,"async"),c["\u0275\u0275elementStart"](15,"span"),c["\u0275\u0275text"](16,"Add your answer..."),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](17,"mg-body-input",12),c["\u0275\u0275listener"]("ngModelChange",(function(e){return t.answerText=e})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](18,B,4,3,"div",13),c["\u0275\u0275elementStart"](19,"div",14),c["\u0275\u0275elementStart"](20,"button",15),c["\u0275\u0275text"](21," Preview "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e){var n=c["\u0275\u0275reference"](6);c["\u0275\u0275property"]("mgOverlayStructure",!0)("mgOverlayStructureRegion","top"),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("innerHTML",c["\u0275\u0275pipeBind1"](3,13,null==t.challenge?null:t.challenge.title),c["\u0275\u0275sanitizeHtml"]),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("fullHtml",null==t.challenge?null:t.challenge.body)("clippedLength",t.challengePreviewLength),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf",!n.shouldShowFullHtml),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngIf",t.isImageChallengeType),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngIf",c["\u0275\u0275pipeBind1"](14,15,t.currentUser$)),c["\u0275\u0275advance"](4),c["\u0275\u0275property"]("richContent",!1)("maxlength",1500)("ngModel",t.answerText),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",!t.uploadedImage&&!t.isImageChallengeType),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("disabled",t.disabledSubmit)}},directives:[y.a,b.a,b.b,p.o,C.E,C.u,C.v,x.a,C.B,C.n,C.t,C.w,w.a,b.c,k.a,P.a,O.a],pipes:[I.a,p.b],styles:['@import url("https://fonts.googleapis.com/css?family=Muli:400,700,900");.title-text[_ngcontent-%COMP%]{margin-bottom:20px;font-family:Muli,sans-serif;line-height:1.35;margin-top:32px}@media (orientation:landscape){.title-text[_ngcontent-%COMP%]{font-size:6.8019323671vh}}@media (orientation:portrait){.title-text[_ngcontent-%COMP%]{font-size:6.8019323671vw}}@media (orientation:landscape) and (max-height:414px){.title-text[_ngcontent-%COMP%]{font-size:28.16px}}@media (orientation:portrait) and (max-width:414px){.title-text[_ngcontent-%COMP%]{font-size:28.16px}}@media (min-width:439.875px){.title-text[_ngcontent-%COMP%]{font-size:29.92px}}@media (max-width:1140px){.title-text[_ngcontent-%COMP%]{margin-top:16px}}.divider[_ngcontent-%COMP%]{width:165px;border-top:6px solid #b2b2b2;margin:auto}[_nghost-%COMP%]{--mg-form-input-border-width:1px}.padded-center-content[_ngcontent-%COMP%]{padding:0 10%}@media (max-width:1140px){.padded-center-content[_ngcontent-%COMP%]{padding:0}}[_nghost-%COMP%]{background-color:#fff;display:block;color:#036;padding:22px 32px}.challenge-info-header[_ngcontent-%COMP%]{text-align:center}.challenge-info-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-family:Caveat,cursive;font-size:48px;font-weight:700;color:#00008b;margin-top:15px;margin-bottom:15px}.challenge-info-header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#93f}@media (min-width:599px){.challenge-info-header[_ngcontent-%COMP%]   mg-clipped-html[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-left:50px;margin-right:50px}}.header-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:8px}.header-container[_ngcontent-%COMP%]   mg-avatar[_ngcontent-%COMP%]{margin-right:14px}mg-file-input-upload[_ngcontent-%COMP%]{background-color:#f5f5f5;margin-bottom:14px}.background-selection-container[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{margin:0;font-weight:700}.background-selection-container[_ngcontent-%COMP%]   mg-challenge-banner-library-stream[_ngcontent-%COMP%]{margin-bottom:26px}.footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .footer[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{margin-left:16px}.footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:1em 60px}']}),n}()},tcBv:function(e,n,i){"use strict";i.d(n,"a",(function(){return O}));var o=i("8Y7J"),a=i("AdbN"),c=i("TNy8"),s=i("E4Uz"),l=i("2nPA"),u=i("0cKA"),d=i("SVse"),f=i("Fudl"),h=i("jcBT"),p=i("StFh"),g=["streamScroller"],m=["colorPickerEl"];function v(e,t){if(1&e){var n=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementContainerStart"](0),o["\u0275\u0275elementStart"](1,"div",9),o["\u0275\u0275listener"]("click",(function(){return o["\u0275\u0275restoreView"](n),o["\u0275\u0275nextContext"](2).onClickColorPicker()})),o["\u0275\u0275elementStart"](2,"mg-icon"),o["\u0275\u0275text"](3,"color-picker"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementContainerEnd"]()}if(2&e){var r=o["\u0275\u0275nextContext"](2);o["\u0275\u0275advance"](1),o["\u0275\u0275styleProp"]("background-color",r.selectedColor)}}function y(e,t){if(1&e&&o["\u0275\u0275template"](0,v,4,2,"ng-container",8),2&e){var n=o["\u0275\u0275nextContext"]();o["\u0275\u0275property"]("ngIf",n.enableColorPicker)}}function b(e,t){if(1&e){var n=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementContainerStart"](0),o["\u0275\u0275elementStart"](1,"div",10),o["\u0275\u0275listener"]("click",(function(){o["\u0275\u0275restoreView"](n);var e=o["\u0275\u0275nextContext"](2);return e.clickItem(e.initialBannerAsset)})),o["\u0275\u0275element"](2,"mg-image",11),o["\u0275\u0275pipe"](3,"mgImageUrls"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementContainerEnd"]()}if(2&e){var r=o["\u0275\u0275nextContext"](2);o["\u0275\u0275advance"](1),o["\u0275\u0275classProp"]("item-selected",r.isBannerSelected(r.initialBannerAsset)),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("srcs",o["\u0275\u0275pipeBind2"](3,3,null==r.initialBannerAsset?null:r.initialBannerAsset.image,r._imagePreviewSizes))}}function C(e,t){if(1&e&&o["\u0275\u0275template"](0,b,4,6,"ng-container",8),2&e){var n=o["\u0275\u0275nextContext"]();o["\u0275\u0275property"]("ngIf",n.initialBannerAsset)}}function x(e,t){1&e&&o["\u0275\u0275element"](0,"div",12)}function w(e,t){if(1&e){var n=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"div",10),o["\u0275\u0275listener"]("click",(function(){o["\u0275\u0275restoreView"](n);var e=t.$implicit;return o["\u0275\u0275nextContext"]().clickItem(e)})),o["\u0275\u0275element"](1,"mg-image",11),o["\u0275\u0275pipe"](2,"mgImageUrls"),o["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,i=o["\u0275\u0275nextContext"]();o["\u0275\u0275classProp"]("item-selected",i.isBannerSelected(r)),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("srcs",o["\u0275\u0275pipeBind2"](2,3,r.image,i._imagePreviewSizes))}}var k=function(e,t){return[e,t]},P=function(e,t,n){return[e,t,n]},O=function(){var e=function(){function e(n,r){t(this,e),this._cdr=n,this.bannerLibrary=r,this._categories=[],this._imagePreviewSizes=["blurloading1",["studio","bannerlibpreview","cardbanner"]],this.solidColorOptions=["#43c2ec","#a7e473","#f4ec60","#eb8b44","#fb7273","#9b7de1","#006177","#519b0b","#ccbd00","#db610e","#e83842","#5427e2"],this._uploadedImage="",this.tag="",this.enableColorPicker=!1,this.selectedColor="#fff",this.type=a.BannerType.CHALLENGE_HEADER,this.searchQuery="",this.selectedAssetId=null,this.initialBannerAsset=null,this.selectedBannerChange=new o.EventEmitter,this.selectedColorChange=new o.EventEmitter}return r(e,[{key:"categories",get:function(){return this._categories},set:function(e){this._categories=e,this._cdr.markForCheck()}},{key:"streamFilter",get:function(){var e="";return this.initialBannerAsset&&(e=this.initialBannerAsset.bannerHash),{query:this.searchQuery,categories:this.categories.join(),excluded:e,type:this.type}}},{key:"isBannerSelected",value:function(e){return!(!this.selectedAssetId||"string"==typeof this.selectedAssetId)&&this.selectedAssetId.bannerHash==e.bannerHash}},{key:"onClickColorPicker",value:function(){this.colorPickerEl&&this.colorPickerEl.nativeElement.click()}},{key:"onColorPickerChange",value:function(e){this.selectedColor=e,this.selectedColorChange.emit(this.selectedColor)}},{key:"clickItem",value:function(e){this.selectedAssetId=e,this.selectedBannerChange.emit(e),this._cdr.markForCheck()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](o.ChangeDetectorRef),o["\u0275\u0275directiveInject"](c.BannerLibrary))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["mg-challenge-banner-library-stream"]],viewQuery:function(e,t){var n;(1&e&&(o["\u0275\u0275viewQuery"](g,1),o["\u0275\u0275viewQuery"](m,1)),2&e)&&(o["\u0275\u0275queryRefresh"](n=o["\u0275\u0275loadQuery"]())&&(t.streamScroller=n.first),o["\u0275\u0275queryRefresh"](n=o["\u0275\u0275loadQuery"]())&&(t.colorPickerEl=n.first))},inputs:{tag:"tag",enableColorPicker:"enableColorPicker",selectedColor:"selectedColor",type:"type",categories:"categories",searchQuery:"searchQuery",selectedAssetId:"selectedAssetId",initialBannerAsset:"initialBannerAsset"},outputs:{selectedBannerChange:"selectedBannerChange",selectedColorChange:"selectedColorChange"},decls:11,vars:17,consts:[["cpOutputFormat","hex","cpPosition","top","cpDialogDisplay","popup",1,"pick-color-container",3,"colorPicker","cpPresetColors","cpCloseClickOutside","cpOKButton","cpOKButtonText","colorPickerChange"],["colorPickerEl",""],["streamColorPicker",""],["initialBanner",""],["streamTailTpl",""],["rpcControl","searchControl","rpcStream","search",3,"filter","service","horizontal","extraHeadItems","extraTailItems"],["streamScroller",""],["mgStreamItem",""],[4,"ngIf"],[1,"pick-color-img",3,"click"],[1,"banner-library-item",3,"click"],[3,"srcs"],[1,"banner-library-item","placeholder"]],template:function(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"div",0,1),o["\u0275\u0275listener"]("colorPickerChange",(function(e){return t.onColorPickerChange(e)})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](2,y,1,1,"ng-template",null,2,o["\u0275\u0275templateRefExtractor"]),o["\u0275\u0275template"](4,C,1,1,"ng-template",null,3,o["\u0275\u0275templateRefExtractor"]),o["\u0275\u0275template"](6,x,1,0,"ng-template",null,4,o["\u0275\u0275templateRefExtractor"]),o["\u0275\u0275elementStart"](8,"mg-stream-scroller",5,6),o["\u0275\u0275template"](10,w,3,6,"ng-template",7),o["\u0275\u0275elementEnd"]()),2&e){var n=o["\u0275\u0275reference"](3),r=o["\u0275\u0275reference"](5),i=o["\u0275\u0275reference"](7);o["\u0275\u0275property"]("colorPicker",t.selectedColor)("cpPresetColors",t.solidColorOptions)("cpCloseClickOutside",!1)("cpOKButton",!0)("cpOKButtonText","Close"),o["\u0275\u0275advance"](8),o["\u0275\u0275property"]("filter",t.streamFilter)("service",t.bannerLibrary)("horizontal",!0)("extraHeadItems",o["\u0275\u0275pureFunction2"](10,k,n,r))("extraTailItems",o["\u0275\u0275pureFunction3"](13,P,i,i,i))}},directives:[s.a,l.a,u.a,d.o,f.a,h.a],pipes:[p.a],styles:["[_nghost-%COMP%]{--feed-item-margin-side:0px}.banner-library-item[_ngcontent-%COMP%]{position:relative;overflow:hidden;width:90px;height:90px;margin:8px;background-color:#f5f5f5;border-radius:0;cursor:pointer;border:2px solid #f5f5f5;transition:border-color .1s ease;display:inline-flex}.banner-library-item.item-selected[_ngcontent-%COMP%]{border-color:#3cf;transition:all .2s ease-in-out;transform:scale(1.1)}.banner-library-item[_ngcontent-%COMP%]   mg-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.banner-library-item.placeholder[_ngcontent-%COMP%]{cursor:default;background-color:initial;-webkit-user-select:none;user-select:none;border-color:transparent;transition:none;animation:none}[_nghost-%COMP%]{display:block;height:135px}mg-stream-scroller[_ngcontent-%COMP%]{display:block;height:100%}.pick-color-img[_ngcontent-%COMP%]{border:1px solid #036;border-radius:0;--mg-icon-size:33px;display:inline-flex;justify-content:center;align-items:center;position:relative;width:90px;height:90px;margin:8px}"],changeDetection:0}),e}()},uDiC:function(n,i,o){"use strict";o.d(i,"a",(function(){return g}));var a=o("mrSG"),c=o("8Y7J"),s=o("LvDl"),l=o("5km/"),u=o("6GgV"),d=o("orC8"),f=o("iELJ");function h(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.merge.apply(s,[e].concat(n))}var p,g=((p=function(){function n(e,r){t(this,n),this.userStorage=e,this.matDialog=r,this._pendingDraft={}}return r(n,[{key:"cancelDraft",value:function(){return Object(a.a)(this,void 0,void 0,e().mark((function t(){var n,r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.matDialog.open(l.g),e.next=3,n.beforeClosed().toPromise();case 3:if("keep"!==(r=e.sent)){e.next=6;break}return e.abrupt("return","");case 6:if("discard"!==r){e.next=10;break}return e.next=9,this.clearDraft();case 9:return e.abrupt("return","");case 10:throw new Error("User abort");case 11:case"end":return e.stop()}}),t,this)})))}},{key:"getDraftType",value:function(t){return Object(a.a)(this,void 0,void 0,e().mark((function n(){var r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=7;break}return e.next=3,this.getDraft();case 3:if(r=e.sent){e.next=6;break}throw new Error("No Challenge Response Draft found for draft type!");case 6:t=r;case 7:return e.abrupt("return",t.type);case 8:case"end":return e.stop()}}),n,this)})))}},{key:"clearDraft",value:function(){return Object(a.a)(this,void 0,void 0,e().mark((function t(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userStorage.setItem("MingaChallengeResponseDraft",null);case 2:case"end":return e.stop()}}),t,this)})))}},{key:"getDraft",value:function(){return Object(a.a)(this,void 0,void 0,e().mark((function t(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userStorage.getItem("MingaChallengeResponseDraft");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=null;case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),t,this)})))}},{key:"getDraftDefaulted",value:function(t,n){return Object(a.a)(this,void 0,void 0,e().mark((function r(){var i;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDraft();case 2:if(i=e.sent,e.t0=!i||t&&i.ownerContextHash!=t,!e.t0){e.next=10;break}return e.next=7,n();case 7:return i=e.sent,e.next=10,this.storeDraft(i);case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),r,this)})))}},{key:"getDefaultResponse",value:function(){return{body:"",privacy:u.ChallengePrivacy.PUBLIC,type:u.ChallengeType.TEXT}}},{key:"getDraftAssert",value:function(){return Object(a.a)(this,void 0,void 0,e().mark((function t(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDraft();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),t,this)})))}},{key:"saveDraft",value:function(t){return Object(a.a)(this,void 0,void 0,e().mark((function n(){var r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign({},this._pendingDraft),this._pendingDraft=h(r,t),e.next=4,this.savePendingDraft();case 4:case"end":return e.stop()}}),n,this)})))}},{key:"saveDraftDelayed",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=Object.assign({},this._pendingDraft);this._pendingDraft=h(r,e),clearTimeout(this.draftSaveTimeout),this.draftSaveTimeout=setTimeout((function(){return t.savePendingDraft()}),n)}},{key:"savePendingDraft",value:function(){return Object(a.a)(this,void 0,void 0,e().mark((function t(){var n,r;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this.draftSaveTimeout),n=Object.assign({},this._pendingDraft),this._pendingDraft={},e.t0=h,e.next=6,this.getDraftAssert();case 6:return e.t1=e.sent,e.t2=n,r=(0,e.t0)(e.t1,e.t2),!n.banner&&n.backgroundColor?r.banner=void 0:n.banner&&!n.backgroundColor&&(r.backgroundColor=void 0),e.next=12,this.storeDraft(r);case 12:case"end":return e.stop()}}),t,this)})))}},{key:"storeDraft",value:function(t){return Object(a.a)(this,void 0,void 0,e().mark((function n(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.userStorage.setItem("MingaChallengeResponseDraft",t);case 2:case"end":return e.stop()}}),n,this)})))}}]),n}()).\u0275fac=function(e){return new(e||p)(c["\u0275\u0275inject"](d.a),c["\u0275\u0275inject"](f.b))},p.\u0275prov=c["\u0275\u0275defineInjectable"]({token:p,factory:p.\u0275fac,providedIn:"root"}),p)}}])}();
//# sourceMappingURL=default~minga-app-src-app-challenge-route-ChallengeRoutes-module~minga-app-src-app-challenge-route-c~d3cb05ea-es5.js.map