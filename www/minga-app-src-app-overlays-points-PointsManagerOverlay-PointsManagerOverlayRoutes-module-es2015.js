(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{"/NSJ":function(e,t,n){"use strict";n.r(t),n.d(t,"PointsManagerOverlayRoutesModule",(function(){return Pe}));var o=n("8Y7J"),i=n("iInd"),a=n("oTGS"),r=n("mrSG"),s=n("rBtp"),l=n("625G"),c=n("iELJ"),d=n("GBt7"),p=n("lOMi"),m=n("tfLw"),g=n("VDRc"),u=n("Hp2Z"),h=n("SVse"),f=n("sj4O"),v=n("cRkC");function x(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"label",6),o["\u0275\u0275elementStart"](1,"mg-button-icon",7),o["\u0275\u0275listener"]("click",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().save()})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](2,"p"),o["\u0275\u0275text"](3),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}if(2&e){const e=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](3),o["\u0275\u0275textInterpolate"](e.data.saveText||"Save")}}function C(e,t){1&e&&(o["\u0275\u0275elementContainerStart"](0),o["\u0275\u0275element"](1,"div",8),o["\u0275\u0275element"](2,"mg-spinner"),o["\u0275\u0275element"](3,"div",8),o["\u0275\u0275elementContainerEnd"]())}function y(e,t){1&e&&(o["\u0275\u0275elementContainerStart"](0),o["\u0275\u0275element"](1,"div",8),o["\u0275\u0275element"](2,"mg-success-checkmark",9),o["\u0275\u0275element"](3,"div",8),o["\u0275\u0275elementContainerEnd"]()),2&e&&(o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("animate",!0))}function S(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementContainerStart"](0),o["\u0275\u0275elementStart"](1,"p",10),o["\u0275\u0275text"](2,"An error has occured"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](3,"div",8),o["\u0275\u0275elementStart"](4,"button",11),o["\u0275\u0275listener"]("click",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().scan()})),o["\u0275\u0275text"](5),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](5),o["\u0275\u0275textInterpolate1"](" ",e.data.scanAgainText||"Scan Again"," ")}}function E(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementContainerStart"](0),o["\u0275\u0275elementStart"](1,"p",10),o["\u0275\u0275text"](2," Unable to find student with ID: "),o["\u0275\u0275elementStart"](3,"strong"),o["\u0275\u0275text"](4),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](5,"div",8),o["\u0275\u0275elementStart"](6,"button",11),o["\u0275\u0275listener"]("click",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().scan()})),o["\u0275\u0275text"](7),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](4),o["\u0275\u0275textInterpolate"](e.unknownStudentId),o["\u0275\u0275advance"](3),o["\u0275\u0275textInterpolate1"](" ",e.data.scanAgainText||"Scan Again"," ")}}function P(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"p",14),o["\u0275\u0275text"](1),o["\u0275\u0275elementEnd"]()),2&e){const e=o["\u0275\u0275nextContext"](2);o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",e.data.confirmPretext," ")}}function I(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementContainerStart"](0),o["\u0275\u0275template"](1,P,2,1,"p",12),o["\u0275\u0275elementStart"](2,"h1",13),o["\u0275\u0275text"](3),o["\u0275\u0275elementEnd"](),o["\u0275\u0275element"](4,"div",8),o["\u0275\u0275elementStart"](5,"button",11),o["\u0275\u0275listener"]("click",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().confirmAndScanAgain()})),o["\u0275\u0275text"](6),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementContainerEnd"]()}if(2&e){const e=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",e.data.confirmPretext),o["\u0275\u0275advance"](2),o["\u0275\u0275textInterpolate"](e.displayData.displayName),o["\u0275\u0275advance"](3),o["\u0275\u0275textInterpolate1"](" ",e.data.confirmText||"Confirm"," ")}}let O=(()=>{class e{constructor(e,t,n,o,i){this.cdr=e,this.peopleCollectionService=t,this.barcodeScanner=n,this.matDialogRef=o,this.data=i,this.confirmingPersonHash="",this.result={personHashList:[]},this.state="loading",this.displayData=null,this.unknownStudentId="",this.matDialogRef.backdropClick().subscribe(()=>{this.close()})}get hasStudentsScanned(){return!!this.result.personHashList.length}ngOnInit(){this.scan()}close(){console.log("close scanner dialog called"),console.log(this.result),this.matDialogRef.close(this.result)}confirmAndScanAgain(){return Object(r.a)(this,void 0,void 0,(function*(){if(this.result.personHashList.push(this.confirmingPersonHash),this.data.onConfirmBeforeScanAgain){this.state="loading",this.cdr.markForCheck();try{yield this.data.onConfirmBeforeScanAgain(this.confirmingPersonHash)}catch(e){throw this.state="error",this.cdr.markForCheck(),e}}this.data.confirmCheckmarkAnimation&&(this.state="confirm-animation",this.cdr.markForCheck(),yield new Promise(e=>setTimeout(e,1e3))),yield this.scan()}))}scan(){return Object(r.a)(this,void 0,void 0,(function*(){this.confirmingPersonHash="";const e=yield this.barcodeScanner.scan();if(console.log("scanner result"),console.log(e),e.cancelled||!e.text)this.matDialogRef.close(this.result);else try{yield this.fetchStudentId(e.text)}catch(t){throw this.state="error",this.cdr.markForCheck(),t}}))}save(){return Object(r.a)(this,void 0,void 0,(function*(){try{yield this.data.onSave(this.result)}catch(e){throw this.state="error",this.cdr.markForCheck(),e}this.close()}))}fetchStudentId(e){return Object(r.a)(this,void 0,void 0,(function*(){const t=new d.GetPersonByStudentIdRequest;t.setStudentId(e);const n=yield this.peopleCollectionService.getPersonByStudentId(t);if(n.hasPerson()){const e=n.getPerson(),t=e.getDisplayName();this.confirmingPersonHash=e.getPersonHash(),this.displayData={displayName:t},this.state="known-student"}else this.unknownStudentId=e,this.state="unknown-student";this.cdr.markForCheck()}))}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](o.ChangeDetectorRef),o["\u0275\u0275directiveInject"](p.PeopleCollection),o["\u0275\u0275directiveInject"](m.a),o["\u0275\u0275directiveInject"](c.g),o["\u0275\u0275directiveInject"](c.a))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],decls:12,vars:7,consts:[["fxLayout","row","fxLayoutAlign","space-between center",1,"actions-container"],["fxLayout","row","fxLayoutAlign","start center",1,"close"],["icon","close",3,"click"],["class","save","fxLayout","row","fxLayoutAlign","start center",4,"ngIf"],["fxLayout","column",1,"mg-centered","contents","user-content",3,"ngSwitch"],[4,"ngSwitchCase"],["fxLayout","row","fxLayoutAlign","start center",1,"save"],["icon","publish",3,"click"],["fxFlex",""],[3,"animate"],[1,"mg-headline","notice-msg"],["mgBubbleBtn","",3,"click"],["class","confirm-pretext mg-bodycopy",4,"ngIf"],[1,"dialog-title","mg-cta"],[1,"confirm-pretext","mg-bodycopy"]],template:function(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"div",0),o["\u0275\u0275elementStart"](1,"label",1),o["\u0275\u0275elementStart"](2,"mg-button-icon",2),o["\u0275\u0275listener"]("click",(function(){return t.close()})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](3,"p"),o["\u0275\u0275text"](4,"Close"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](5,x,4,1,"label",3),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](6,"div",4),o["\u0275\u0275template"](7,C,4,0,"ng-container",5),o["\u0275\u0275template"](8,y,4,1,"ng-container",5),o["\u0275\u0275template"](9,S,6,1,"ng-container",5),o["\u0275\u0275template"](10,E,8,2,"ng-container",5),o["\u0275\u0275template"](11,I,7,3,"ng-container",5),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275advance"](5),o["\u0275\u0275property"]("ngIf",t.data.onSave&&(t.hasStudentsScanned||"known-student"==t.state)),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngSwitch",t.state),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngSwitchCase","loading"),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngSwitchCase","confirm-animation"),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngSwitchCase","error"),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngSwitchCase","unknown-student"),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngSwitchCase","known-student"))},directives:[g.e,g.d,u.a,h.o,h.q,h.r,g.b,f.a,v.a],styles:[".contents[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;flex-direction:column;flex:1}.actions-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;width:100%;transform:translateY(-110%)}button[_ngcontent-%COMP%]{display:block;width:100%;height:150px;font-size:22px;font-weight:700}.confirm-pretext[_ngcontent-%COMP%]{margin-bottom:4px}.dialog-title[_ngcontent-%COMP%]{margin-top:4px}.notice-msg[_ngcontent-%COMP%]{margin-top:32px}"],changeDetection:0}),e})();var k=n("u9T3"),b=n("CO6v");n("eJkR"),n("7Tcv");let w=(()=>{class e{constructor(e){this.matDialog=e}open(e){return this.matDialog.open(O,Object.assign(Object.assign({},e),{disableClose:!0}))}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](c.b))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var M=n("OeFH"),T=n("tfHx");let D=(()=>{class e extends s.a{constructor(e,t,n,o){super(n,o),this._pointsManager=e,this._studentIdScannerDialog=t,this.dataSource=n,this.modalOverlayService=o,this.pageTitle="Points People Search",this.canAddSaveWithBarcodeScanner=!1}getItemId(e){return e.personHash}save(){return Object(r.a)(this,void 0,void 0,(function*(){return this.selected.map(e=>e.personHash),this.selected.length?(this._pointsManager.storeTempPointsPeople(this.selected),{shouldClose:!0}):{}}))}addSaveWithBarcodeScanner(e){return Object(r.a)(this,void 0,void 0,(function*(){}))}afterSaveWithBarcodeScanner(e,t){return Object(r.a)(this,void 0,void 0,(function*(){}))}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275inject"](l.c),o["\u0275\u0275inject"](w),o["\u0275\u0275inject"](M.a),o["\u0275\u0275inject"](T.e))},e.\u0275prov=o["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();var A=n("oy35"),_=n("5MXc"),V=n("PLeU"),R=n("UWMR"),j=n("GFah"),L=n("yjOL"),F=n("M4qg"),H=n("BxgO"),N=n("uplL"),B=n("kCL4"),q=n("s7LF"),z=n("Q2Ze"),G=n("i1AJ"),J=n("e6WT"),U=n("ZTz/"),W=n("UhP/"),$=n("f44v"),Y=n("Tj54"),Z=n("TSSN");function K(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"div",null,6),o["\u0275\u0275elementStart"](2,"mg-overlay-nav-item",7),o["\u0275\u0275listener"]("click",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().onOverlayNavItemClick()})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}if(2&e){const e=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("icon",e.overlayNavItemIcon)}}function Q(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"p",8),o["\u0275\u0275text"](1," Add or Remove points from teams or individuals.\n"),o["\u0275\u0275elementEnd"]())}function X(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"p",8),o["\u0275\u0275text"](1),o["\u0275\u0275elementEnd"]()),2&e){const e=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" How many points do you want to ","ADD"==e.page?"add":"remove","?\n")}}function ee(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"div",9),o["\u0275\u0275elementStart"](1,"div",10),o["\u0275\u0275elementStart"](2,"div",11),o["\u0275\u0275elementStart"](3,"div",12),o["\u0275\u0275text"](4,"TEAMS"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](5,"mg-generic-button",13),o["\u0275\u0275listener"]("onClick",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().onAddPointsTeam()})),o["\u0275\u0275text"](6," Add Points "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](7,"mg-generic-button",14),o["\u0275\u0275listener"]("onClick",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().onRemovePointsTeam()})),o["\u0275\u0275text"](8," Remove Points "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](9,"div",11),o["\u0275\u0275elementStart"](10,"div",12),o["\u0275\u0275text"](11,"INDIVIDUALS"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](12,"mg-generic-button",13),o["\u0275\u0275listener"]("onClick",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().onAddPointsPeople()})),o["\u0275\u0275text"](13," Add Points "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](14,"mg-generic-button",14),o["\u0275\u0275listener"]("onClick",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().onRemovePointsPeople()})),o["\u0275\u0275text"](15," Remove Points "),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}}function te(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"mat-option",31),o["\u0275\u0275text"](1),o["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;o["\u0275\u0275property"]("value",e),o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function ne(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"mat-form-field",29),o["\u0275\u0275elementStart"](1,"mat-label"),o["\u0275\u0275text"](2,"Select a Team"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](3,"mat-select",30),o["\u0275\u0275listener"]("ngModelChange",(function(t){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"](2).selectedTeam=t})),o["\u0275\u0275template"](4,te,2,2,"mat-option",26),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}if(2&e){const e=o["\u0275\u0275nextContext"](2);o["\u0275\u0275advance"](3),o["\u0275\u0275property"]("ngModel",e.selectedTeam)("required",!0),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngForOf",e.teams)}}function oe(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"mat-chip",37),o["\u0275\u0275listener"]("keydown",(function(n){o["\u0275\u0275restoreView"](e);const i=t.$implicit,a=t.index;o["\u0275\u0275nextContext"]();const r=o["\u0275\u0275reference"](4);return o["\u0275\u0275nextContext"](2).onChipKeydown(n,i,a,r)}))("click",(function(){o["\u0275\u0275restoreView"](e);const n=t.index;o["\u0275\u0275nextContext"]();const i=o["\u0275\u0275reference"](4);return o["\u0275\u0275nextContext"](2).onRemovePerson(n,i)})),o["\u0275\u0275text"](1),o["\u0275\u0275elementStart"](2,"mat-icon",38),o["\u0275\u0275listener"]("click",(function(){o["\u0275\u0275restoreView"](e);const n=t.index;o["\u0275\u0275nextContext"]();const i=o["\u0275\u0275reference"](4);return o["\u0275\u0275nextContext"](2).onRemovePerson(n,i)})),o["\u0275\u0275text"](3,"close"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;o["\u0275\u0275property"]("removable",!0)("selectable",!0),o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",e.displayName," ")}}function ie(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"mat-form-field",32),o["\u0275\u0275elementStart"](1,"mat-label"),o["\u0275\u0275text"](2,"People"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](3,"mat-chip-list",null,33),o["\u0275\u0275template"](5,oe,4,3,"mat-chip",34),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](6,"input",35,36),o["\u0275\u0275listener"]("ngModelChange",(function(t){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"](2).peopleValue=t})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](8,"mat-error"),o["\u0275\u0275text"](9),o["\u0275\u0275pipe"](10,"translate"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementEnd"]()}if(2&e){const e=o["\u0275\u0275reference"](4),t=o["\u0275\u0275nextContext"](2);o["\u0275\u0275advance"](5),o["\u0275\u0275property"]("ngForOf",t.people),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("matChipInputFor",e)("ngModel",t.peopleValue)("required",!1),o["\u0275\u0275advance"](3),o["\u0275\u0275textInterpolate1"](" ",o["\u0275\u0275pipeBind1"](10,5,"input.pointsPeople.error.required")," ")}}function ae(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"mat-error"),o["\u0275\u0275text"](1),o["\u0275\u0275pipe"](2,"translate"),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",o["\u0275\u0275pipeBind1"](2,1,"input.points.error.required")," "))}function re(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"mat-hint",39),o["\u0275\u0275text"](1),o["\u0275\u0275elementEnd"]()),2&e){const e=o["\u0275\u0275nextContext"](2);o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",e.pointsReason.length," / 64 ")}}function se(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"mat-error"),o["\u0275\u0275text"](1),o["\u0275\u0275pipe"](2,"translate"),o["\u0275\u0275elementEnd"]()),2&e&&(o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",o["\u0275\u0275pipeBind1"](2,1,"input.pointsReason.error.required")," "))}function le(e,t){if(1&e&&(o["\u0275\u0275elementStart"](0,"mat-option",31),o["\u0275\u0275text"](1),o["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;o["\u0275\u0275property"]("value",e),o["\u0275\u0275advance"](1),o["\u0275\u0275textInterpolate1"](" ",e," ")}}function ce(e,t){1&e&&(o["\u0275\u0275elementStart"](0,"mat-error"),o["\u0275\u0275text"](1," You must select a category "),o["\u0275\u0275elementEnd"]())}function de(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"mg-generic-button",40),o["\u0275\u0275listener"]("onClick",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"](2).onAddPoints()})),o["\u0275\u0275text"](1," Add Points "),o["\u0275\u0275elementEnd"]()}if(2&e){o["\u0275\u0275nextContext"]();const e=o["\u0275\u0275reference"](1),t=o["\u0275\u0275nextContext"]();o["\u0275\u0275property"]("isDisabled",e.invalid||t.extraInvalidCheck)}}function pe(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"mg-generic-button",41),o["\u0275\u0275listener"]("onClick",(function(){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"](2).onRemovePoints()})),o["\u0275\u0275text"](1," Remove Points "),o["\u0275\u0275elementEnd"]()}if(2&e){o["\u0275\u0275nextContext"]();const e=o["\u0275\u0275reference"](1),t=o["\u0275\u0275nextContext"]();o["\u0275\u0275property"]("isDisabled",e.invalid||t.extraInvalidCheck)}}function me(e,t){if(1&e){const e=o["\u0275\u0275getCurrentView"]();o["\u0275\u0275elementStart"](0,"form",null,15),o["\u0275\u0275template"](2,ne,5,3,"mat-form-field",16),o["\u0275\u0275template"](3,ie,11,7,"mat-form-field",17),o["\u0275\u0275elementStart"](4,"mat-form-field",18),o["\u0275\u0275elementStart"](5,"mat-label"),o["\u0275\u0275text"](6,"Points"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](7,"input",19,20),o["\u0275\u0275listener"]("ngModelChange",(function(t){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().pointsValue=t})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](9,ae,3,3,"mat-error",5),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](10,"mat-form-field",18),o["\u0275\u0275elementStart"](11,"mat-label"),o["\u0275\u0275text"](12,"Reason"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](13,"input",21,22),o["\u0275\u0275listener"]("ngModelChange",(function(t){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().pointsReason=t})),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](15,re,2,1,"mat-hint",23),o["\u0275\u0275template"](16,se,3,3,"mat-error",5),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](17,"mat-form-field",18),o["\u0275\u0275elementStart"](18,"mat-label"),o["\u0275\u0275text"](19,"Category"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275elementStart"](20,"mat-select",24,25),o["\u0275\u0275listener"]("ngModelChange",(function(t){return o["\u0275\u0275restoreView"](e),o["\u0275\u0275nextContext"]().pointCategory=t})),o["\u0275\u0275template"](22,le,2,2,"mat-option",26),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](23,ce,2,0,"mat-error",5),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](24,de,2,1,"mg-generic-button",27),o["\u0275\u0275template"](25,pe,2,1,"mg-generic-button",28),o["\u0275\u0275elementEnd"]()}if(2&e){const e=o["\u0275\u0275reference"](8),t=o["\u0275\u0275reference"](14),n=o["\u0275\u0275reference"](21),i=o["\u0275\u0275nextContext"]();o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngIf","TEAM"==i.pageType&&i.teams.length),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",!1),o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("ngModel",i.pointsValue)("required",!0)("placeholder",i.pointsInputPlaceholder),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngIf",null==e||null==e.errors?null:e.errors.required),o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("ngModel",i.pointsReason)("required",!0)("placeholder",i.reasonInputPlaceholder),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngIf",i.pointsReason),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",null==t||null==t.errors?null:t.errors.required),o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("ngModel",i.pointCategory),o["\u0275\u0275advance"](2),o["\u0275\u0275property"]("ngForOf",i.pointCategories),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf",null==n||null==n.errors?null:n.errors.required),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf","ADD"==i.page),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf","REMOVE"==i.page)}}var ge=function(e){return e.CHOICES="CHOICES",e.ADD="ADD",e.REMOVE="REMOVE",e}({}),ue=function(e){return e.TEAM="TEAM",e.PEOPLE="PEOPLE",e.NONE="NONE",e}({});let he=(()=>{class e{constructor(e,t,n,o,i,a,r){this._router=e,this._pointsManager=t,this._snackBar=n,this._rootService=o,this._cdr=i,this._pointsDialog=a,this._peopleSelector=r,this.page=ge.CHOICES,this.pageType=ue.NONE,this.pointCategories=[],this.pointsReason="",this.pointCategory="",this.peopleValue="",this.teams=[],this.people=[],this.init()}get pointsInputPlaceholder(){return"How many points do you want to "+("ADD"===this.page?"give":"remove")+"?"}get reasonInputPlaceholder(){return"Why are you "+("ADD"===this.page?"giving":"removing")+" these points?"}get extraInvalidCheck(){return this.pageType!==ue.PEOPLE&&!this.selectedTeam}get overlayNavItemIcon(){return this.page===ge.CHOICES?"close":"back"}init(){return Object(r.a)(this,void 0,void 0,(function*(){const e=this._pointsManager.consumePointsPeople();e.type?yield this.initForPreselectedState(e):e.people.length&&e.state&&(this.people=e.people,this.pageType=ue.PEOPLE,this.page=e.state===l.d.ADD?ge.ADD:ge.REMOVE,this._cdr.markForCheck());const t=yield this._pointsManager.getPointCategories();this.pointCategories=t.categoriesList}))}initForPreselectedState(e){return Object(r.a)(this,void 0,void 0,(function*(){this.page=e.state===l.d.ADD?ge.ADD:ge.REMOVE,e.type===l.e.PEOPLE?(this.pageType=ue.PEOPLE,this.gotoPersonSearch()):(yield this.initTeams())&&(this.pageType=ue.TEAM)}))}gotoPersonSearch(){this._pointsManager.setTempPointsPeopleState("ADD"===this.page?l.d.ADD:l.d.REMOVE),this._router.navigate(["",{outlets:{o:["points-manager"]}}])}onOverlayNavItemClick(){this.page===ge.ADD||this.page===ge.REMOVE?(this.page=ge.CHOICES,this.pageType=ue.NONE,this._cdr.markForCheck()):this.onOverlayClose()}onOverlayClose(){Object(V.a)(this._router)}initTeams(){return Object(r.a)(this,void 0,void 0,(function*(){if(!this.teams.length)return this.teams=yield this._rootService.addLoadingPromise(this._pointsManager.getPointsTeams()),this.teams.length?(this._cdr.markForCheck(),!0):(this._snackBar.open("No teams available to add/remove points, add teams and try again."),!1)}))}onChipKeydown(e,t,n,o){"Backspace"===e.key&&this.onRemovePerson(n,o)}onRemovePerson(e,t){this.people.splice(e,1),t&&(t.errorState=!this.people.length,this._cdr.markForCheck())}onAddPointsTeam(){return Object(r.a)(this,void 0,void 0,(function*(){(yield this.initTeams())&&(this.page=ge.ADD,this.pageType=ue.TEAM)}))}onAddPointsPeople(){this.page=ge.ADD,this.pageType=ue.PEOPLE,this.gotoPersonSearch()}onRemovePointsTeam(){return Object(r.a)(this,void 0,void 0,(function*(){(yield this.initTeams())&&(this.page=ge.REMOVE,this.pageType=ue.TEAM)}))}onRemovePointsPeople(){this.page=ge.REMOVE,this.pageType=ue.PEOPLE,this.gotoPersonSearch()}onAddPoints(){var e;return Object(r.a)(this,void 0,void 0,(function*(){try{if(this.pageType===ue.TEAM){if(this.selectedTeam&&this.selectedTeam.teamId||this._snackBar.open("Select a team to add points to."),null===(e=this.selectedTeam)||void 0===e?void 0:e.teamId){const e=this._pointsManager.addPointsToTeam(this.selectedTeam.teamId,this.pointsValue||0,this.pointsReason,this.pointCategory);yield this._rootService.addLoadingPromise(e)}}else yield this._peopleSelector.open("Points","redeem",{data:{value:this.pointsValue||0,reason:this.pointsReason,category:this.pointCategory,type:"add"}});this.onOverlayClose()}catch(t){this._snackBar.open("An error occured, please try again."),console.error(t)}}))}onRemovePoints(){var e;return Object(r.a)(this,void 0,void 0,(function*(){try{if(this.pageType===ue.TEAM){if(this.selectedTeam&&this.selectedTeam.teamId||this._snackBar.open("Select a team to remove points from."),null===(e=this.selectedTeam)||void 0===e?void 0:e.teamId){const e=this._pointsManager.removePointsFromTeam(this.selectedTeam.teamId,this.pointsValue||0,this.pointsReason);yield this._rootService.addLoadingPromise(e)}}else yield this._peopleSelector.open("Points","redeem",{data:{value:this.pointsValue||0,reason:this.pointsReason,category:this.pointCategory,type:"remove"}});this.onOverlayClose()}catch(t){this._snackBar.open("An error occured, please try again."),console.error(t)}}))}}return e.\u0275fac=function(t){return new(t||e)(o["\u0275\u0275directiveInject"](i.g),o["\u0275\u0275directiveInject"](l.c),o["\u0275\u0275directiveInject"](R.b),o["\u0275\u0275directiveInject"](j.a),o["\u0275\u0275directiveInject"](o.ChangeDetectorRef),o["\u0275\u0275directiveInject"](L.b),o["\u0275\u0275directiveInject"](F.PeopleSelectorService))},e.\u0275cmp=o["\u0275\u0275defineComponent"]({type:e,selectors:[["mg-points-manager-overlay"]],decls:8,vars:6,consts:[[4,"mgOverlayStructure","mgOverlayStructureRegion"],[1,"trophy-icon"],[1,"uppercase-text","title"],["class","subtitle",4,"ngIf"],["class","choice-grid",4,"ngIf"],[4,"ngIf"],["overlayNavTop",""],[1,"mg-align-left",3,"icon","click"],[1,"subtitle"],[1,"choice-grid"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","space-evenly center","fxLayoutGap","40px"],["fxLayout","column","fxLayoutGap","15px"],[1,"uppercase-text"],["colorTheme","dark-blue","size","large","paddingSize","large",3,"onClick"],["colorTheme","dark-blue","size","large","paddingSize","large","variant","secondary",3,"onClick"],["pointsForm","ngForm"],["mgFormField","",4,"ngIf"],["mgFormField","","mgHideOptionalMarker","true","mgHideInputElement","true",4,"ngIf"],["mgFormField","","hideRequiredMarker",""],["type","number","name","pointsInput","autocomplete","off","matInput","",3,"ngModel","required","placeholder","ngModelChange"],["pointsInput","ngModel"],["type","text","name","reasonInput","autocomplete","off","matInput","","maxLength","64",3,"ngModel","required","placeholder","ngModelChange"],["reasonInput","ngModel"],["align","end",4,"ngIf"],["name","pointCategory","required","",3,"ngModel","ngModelChange"],["categoryInput","ngModel"],[3,"value",4,"ngFor","ngForOf"],["colorTheme","dark-blue","size","large","paddingSize","large",3,"isDisabled","onClick",4,"ngIf"],["colorTheme","dark-blue","size","large","paddingSize","large","variant","secondary",3,"isDisabled","onClick",4,"ngIf"],["mgFormField",""],["name","selectTeamEl",3,"ngModel","required","ngModelChange"],[3,"value"],["mgFormField","","mgHideOptionalMarker","true","mgHideInputElement","true"],["chipList",""],[3,"removable","selectable","keydown","click",4,"ngFor","ngForOf"],["matInput","","name","peopleInput","autocomplete","off","disabled","",3,"matChipInputFor","ngModel","required","ngModelChange"],["peopleInput","ngModel"],[3,"removable","selectable","keydown","click"],["matChipRemove","",3,"click"],["align","end"],["colorTheme","dark-blue","size","large","paddingSize","large",3,"isDisabled","onClick"],["colorTheme","dark-blue","size","large","paddingSize","large","variant","secondary",3,"isDisabled","onClick"]],template:function(e,t){1&e&&(o["\u0275\u0275template"](0,K,3,1,"div",0),o["\u0275\u0275element"](1,"div",1),o["\u0275\u0275elementStart"](2,"p",2),o["\u0275\u0275text"](3,"MANAGE POINTS"),o["\u0275\u0275elementEnd"](),o["\u0275\u0275template"](4,Q,2,0,"p",3),o["\u0275\u0275template"](5,X,2,1,"p",3),o["\u0275\u0275template"](6,ee,16,0,"div",4),o["\u0275\u0275template"](7,me,26,16,"form",5)),2&e&&(o["\u0275\u0275property"]("mgOverlayStructure",!0)("mgOverlayStructureRegion","top"),o["\u0275\u0275advance"](4),o["\u0275\u0275property"]("ngIf","CHOICES"==t.page),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf","ADD"==t.page||"REMOVE"==t.page),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf","CHOICES"==t.page),o["\u0275\u0275advance"](1),o["\u0275\u0275property"]("ngIf","ADD"==t.page||"REMOVE"==t.page))},directives:[H.a,h.o,N.a,g.e,g.d,g.f,B.a,q.E,q.u,q.v,z.d,G.a,z.h,q.y,J.b,q.d,q.t,q.w,q.B,U.a,h.n,W.m,$.c,$.b,z.c,$.a,Y.a,$.d,z.g],pipes:[Z.d],styles:["[_nghost-%COMP%]{text-align:center;display:block;padding:42px 52px}@media (orientation:landscape){[_nghost-%COMP%]{padding-left:4.8vh}}@media (orientation:portrait){[_nghost-%COMP%]{padding-left:4.8vw}}@media (orientation:landscape) and (max-height:375px){[_nghost-%COMP%]{padding-left:18px}}@media (orientation:portrait) and (max-width:375px){[_nghost-%COMP%]{padding-left:18px}}@media (min-width:1083.3333333333px){[_nghost-%COMP%]{padding-left:52px}}@media (orientation:landscape){[_nghost-%COMP%]{padding-right:4.8vh}}@media (orientation:portrait){[_nghost-%COMP%]{padding-right:4.8vw}}@media (orientation:landscape) and (max-height:375px){[_nghost-%COMP%]{padding-right:18px}}@media (orientation:portrait) and (max-width:375px){[_nghost-%COMP%]{padding-right:18px}}@media (min-width:1083.3333333333px){[_nghost-%COMP%]{padding-right:52px}}.trophy-icon[_ngcontent-%COMP%]{background-image:url(/assets/points/trophy.svg);background-repeat:no-repeat;margin:auto;height:132px;width:132px}.uppercase-text[_ngcontent-%COMP%]{text-transform:uppercase;font-size:18px;font-weight:700}.title[_ngcontent-%COMP%]{margin-bottom:7px}.subtitle[_ngcontent-%COMP%]{font-size:14px}mat-chip[_ngcontent-%COMP%]{background-color:#036!important;color:#fff!important}mat-chip[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff!important;opacity:.8}.minga-form-field-underline[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),e})();var fe=n("HxU+"),ve=n("ls3q"),xe=n("CL15"),Ce=n("Ogcz"),ye=n("OLhe");let Se=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({imports:[[xe.a,ve.a,b.a,Ce.b,fe.a,Z.c,L.a,a.a,ye.a,q.m,h.c,z.f,Y.b,U.b,J.c,i.k,$.e,k.a]]}),e})();const Ee=[{path:"",component:he},{path:"search",component:A.a,canDeactivate:[a.c]}];let Pe=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=o["\u0275\u0275defineInjector"]({providers:[{provide:M.a,useClass:_.a},{provide:s.a,useClass:D}],imports:[[Se,i.k.forChild(Ee)]]}),e})()}}]);
//# sourceMappingURL=minga-app-src-app-overlays-points-PointsManagerOverlay-PointsManagerOverlayRoutes-module-es2015.js.map